{"version":3,"sources":["components/Login.tsx","config.ts","api/Api.tsx","test.mp3","img/example-cover.jpg","components/Message.tsx","api/Audio.tsx","api/Hooks.tsx","components/Cell.tsx","components/Dialog.tsx","components/Shared.tsx","components/ActiveSong.tsx","components/Upload.tsx","components/SongList.tsx","components/Albums.tsx","components/Artists.tsx","components/NavBar.tsx","components/Settings.tsx","components/Player.tsx","components/Playlists.tsx","components/PlaylistsBar.tsx","api/Seeder.ts","components/Seeder.tsx","components/Songs.tsx","components/App.tsx","serviceWorker.ts","index.tsx"],"names":["Login","useState","username","setUsername","password","setPassword","error","setError","className","onSubmit","e","string","preventDefault","API","login","Buffer","toString","catch","message","htmlFor","id","type","placeholder","onChange","target","value","required","href","API_URL","observers","Set","observer","url","params","callback","this","fetch","then","r","undefined","forEach","o","call","add","delete","endpoint","query","querystring","encode","method","key","localStorage","getItem","JSON","parse","getApiKey","console","log","apiKey","Error","headers","response","status","statusText","arrayBuffer","buffer","blob","Blob","URL","createObjectURL","file","startsWith","body","FormData","append","toUpperCase","args","update","stringify","json","removeItem","window","location","reload","base64","navigator","platform","vendor","date","format","Date","purpose","setItem","module","exports","Message","text","close","icon","faBomb","faInfoCircle","faCheck","faExclamationTriangle","onClick","MessageContext","React","createContext","useMessages","useContext","messages","setMessages","useEffect","i","setInterval","length","now","getTime","m","filter","clearTimeout","old","slice","clear","index","n","splice","Provider","Messages","TransitionGroup","map","CSSTransition","timeout","Context","usePlayer","context","useCreateAudio","song","setSong","shuffle","setShuffle","repeat","setRepeat","position","setPosition","unshuffled","setSongs","shuffled","useMemo","sort","Math","random","songs","setIndex","audio","a","Audio","crossOrigin","queue","s","title","remove","useQueue","currentTime","addEventListener","removeEventListener","play","ss","Array","isArray","s1","indexOf","Api","src","next","duration","pause","previous","playing","paused","SongButton","selected","disabled","classes","faPause","faPlay","useApi","result","setResult","loading","setLoading","setMessage","subscribe","useApiBunch","endpoints","unfiltered","setResults","results","unsubscribers","rs","u","useApiList","models","objects","b","useLoadingList","render","Loading","faSpinner","useLoading","Cell","props","children","area","style","other","gridArea","DialogContext","useDialog","open","Dialog","ref","useRef","listener","keyCode","ICONS","faHeadphones","faMusic","faGuitar","faDrum","faRecordVinyl","faCompactDisc","Cover","alt","rest","hasImage","setImage","floor","onLoad","onError","draggable","ModelView","create","useParams","ModelSidebar","Single","match","name","Create","setName","post","active","faPlus","to","ActiveCover","album","cover_url","ActiveSong","Upload","memo","files","setFiles","uploading","setUploading","role","faUpload","multiple","accept","hidden","f","Uploading","done","setDone","substring","lastIndexOf","upload","ModelSelect","state","highlight","initial","setCreate","sorted","set","v","v2","resource_uri","MultiModelSelect","model","action","LoadedSongEditor","setTitle","setAlbum","artists","setArtists","every","includes","data","put","useSelection","multi","setSelected","saved","setSaved","last","setLast","ids","ctrlKey","isSelected","events","is","onMouseDown","shiftKey","push","onMouseUp","shift","lower","min","upper","max","onMouseMove","buttons","SongAdder","playlists","Promise","all","playlist","Songs","selection","actions","display","SongRow","faEdit","faList","IconButton","LoadingSongRow","Artist","Album","Active","songURLs","SongList","Albums","Artists","albums","release","t","rowSpan","Nav","path","useLocation","pathname","links","faUser","faDoorOpen","DEFAULT_SETTINGS","theme","SettingsContext","Settings","setSettings","themes","faMoon","faSun","faFire","Queue","sources","source","Fragment","timestamp","time","minutes","seconds","toFixed","padStart","SongInfo","width","Volume","volume","saveVolumed","saveVolume","setVolume","clamped","toggleVolume","useVolume","faVolumeMute","faVolumeDown","faVolumeUp","adjust","w","currentTarget","offsetWidth","l","getBoundingClientRect","left","x","clientX","Player","faStepBackward","faStepForward","faRandom","faRedoAlt","faCog","songsinplaylist","contained","newSongs","faTrash","Playlists","p","Playlist","songNames","artistNames","range","array","SEEDER","count","artistIds","fill","_","millis","res","setTimeout","generator","tracker","setProgress","setTotal","require","seedModels","uploadFile","wait","ignore","Endpoint","Seeder","progress","total","Object","keys","toLowerCase","seed","SinglePage","Logout","logout","Page","page","document","charAt","component","App","loggedIn","setLoggedIn","isLoggedIn","dialog","defaultSettings","settings","useSettings","pages","PlaylistsBar","exact","Boolean","hostname","ReactDOM","StrictMode","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"0IAqEeA,IArDD,WAAO,IAAD,EAEgBC,mBAAS,IAFzB,mBAETC,EAFS,KAECC,EAFD,OAGgBF,mBAAS,IAHzB,mBAGTG,EAHS,KAGCC,EAHD,OAIUJ,mBAAwB,MAJlC,mBAITK,EAJS,KAIFC,EAJE,KAMhB,OACI,yBAAKC,UAAU,cACX,0BAAMC,SAAU,SAAAC,GAhB5B,IAAgBC,EAiBAD,EAAEE,iBACFC,IAAIC,OAlBJH,EAkBiB,GAAD,OAAIT,EAAJ,YAAgBE,GAjBrC,IAAIW,EAAOJ,GAAQK,SAAS,YAkBlBC,OAAM,SAAAP,GAAC,OAAIH,EAASG,EAAEQ,cAG3B,qCAECZ,GAAS,uBAAGE,UAAU,SAASF,GAEhC,6BACI,2BAAOa,QAAQ,YAAf,YACA,2BACIC,GAAG,WACHC,KAAK,OACLC,YAAY,WACZC,SAAU,SAAAb,GAAC,OAAIP,EAAYO,EAAEc,OAAOC,QACpCA,MAAOvB,EACPwB,UAAQ,KAIhB,6BACI,2BAAOP,QAAQ,YAAf,YACA,2BACIC,GAAG,WACHC,KAAK,WACLC,YAAY,WACZC,SAAU,SAAAb,GAAC,OAAIL,EAAYK,EAAEc,OAAOC,QACpCA,MAAOrB,EACPsB,UAAQ,KAIhB,4BAAQL,KAAK,UAAb,SAEA,uBAAGM,KAAI,oCAAP,iB,yJCxDHC,EAAO,UADH,GACG,W,iBC8Ndf,EAAM,I,iDA9MAgB,UAAiC,IAAIC,I,iDAErCC,GAAyB,IACrBC,EAA0BD,EAA1BC,IAAKC,EAAqBF,EAArBE,OAAQC,EAAaH,EAAbG,SACrBC,KAAKC,MAASJ,EAAKC,GACdI,MAAK,SAAAC,GAAC,OAAIJ,EAASI,MACnBrB,OAAM,SAAAP,GAAC,OAAIwB,OAASK,EAAW7B,Q,+BAM9B,IAAD,OACLyB,KAAKN,UAAUW,SAAQ,SAAAC,GAAC,OAAI,EAAKC,KAAKD,Q,gCAS7BT,EAAaC,GAAwC,IAAD,OAC7D,MAAO,CACHI,KAAM,SAACH,GACH,IAAMO,EAAI,CAAET,MAAKC,SAAQC,YAGzB,OAFA,EAAKL,UAAUc,IAAIF,GACnB,EAAKC,KAAKD,GACH,WACH,EAAKZ,UAAUe,OAAOH,Q,qEAWvBI,EAAkBZ,G,8EACvBa,EAA0B,kBAAXb,EAAsBA,EAASc,IAAYC,OAAZ,OAAmBf,QAAnB,IAAmBA,IAAU,I,kBAC1EE,KAAKc,OAAU,MAAf,UAAyBJ,EAAzB,aAAsCC,K,2IAO7C,IAAMI,EAAMC,aAAaC,QAAQ,UACjC,OAAIF,EAAYG,KAAKC,MAAMJ,GACpB,O,gJAOFf,KAAKoB,Y,0CAAoB,G,gCAEvBpB,KAAKC,MAAM,UACbC,MAAK,kBAAM,KACXpB,OAAM,SAAAP,GAGH,OAFA8C,QAAQC,IAAI/C,IAEL,M,2KASAsB,G,gFACT0B,EAASvB,KAAKoB,Y,sBACD,IAAII,MAAM,iB,uBAENvB,MAAM,IAAD,OAAKJ,GAAO,CACpC4B,QAAS,CACL,cAAiBF,EAAOR,O,UAIR,OANlBW,E,QAMOC,O,sBAAsB,IAAIH,MAAME,EAASE,Y,wBAEjCF,EAASG,c,eAAxBC,E,OAEAC,EAAO,IAAIC,KAAK,CAACF,GAAS,CAAE5C,KAAM,Y,kBACjC+C,IAAIC,gBAAgBH,I,8KAUlBrB,EAAkByB,G,4FAAYrB,E,+BAAiB,OAClDS,EAASvB,KAAKoB,Y,sBACD,IAAII,MAAM,iB,cAEzB3B,EAAMa,GACD0B,WAAW3C,KAAUI,EAAG,UAAMJ,EAAN,YAAiBI,IAClDA,GAAO,KAEDwC,EAAO,IAAIC,UACZC,OAAO,QAASJ,G,UAERlC,MAAMJ,EAAK,CACpBiB,OAAQA,EAAO0B,cACff,QAAS,CACL,OAAU,mBAEV,cAAiBF,EAAOR,KAE5BsB,S,yNAIgBvB,EAAgBJ,EAAkB+B,G,4FAAYC,I,iCAC5DnB,EAASvB,KAAKoB,Y,sBACD,IAAII,MAAM,iB,cAEzB3B,EAAMa,GACD0B,WAAW3C,KAAUI,EAAG,UAAMJ,EAAN,YAAiBI,IACnC,QAAXiB,IAAkBjB,GAAO,K,SAENI,MAAMJ,EAAK,CAC9BiB,OAAQA,EAAO0B,cACff,QAAS,CACL,OAAU,mBACV,eAAgB,mBAChB,cAAiBF,EAAOR,KAE5BsB,KAAMI,EAAOvB,KAAKyB,UAAUF,QAAQrC,I,UAPlCsB,E,OAUFgB,GAAqB,QAAX5B,GAAkBd,KAAK0C,SAEb,MAApBhB,EAASC,O,0CACFD,EAASkB,Q,cAEV,IAAIpB,MAAM,iB,gLAID3B,G,4FAAa4C,E,+BAAY,GAAIC,I,mDACzC1C,KAAKc,OAAU,OAAQjB,EAAK4C,EAAMC,I,0KAGvB7C,G,4FAAa4C,E,+BAAY,GAAIC,I,mDACxC1C,KAAKc,OAAU,MAAOjB,EAAK4C,EAAMC,I,6KAGnB7C,G,4FAAa4C,E,+BAAY,GAAIC,I,mDAC3C1C,KAAKc,OAAU,SAAUjB,EAAK4C,EAAMC,I,2PAIrCnB,EAASvB,KAAKoB,a,gCAEFpB,KAAKS,OAAL,iBAAsBc,EAAOtC,KAC1CH,OAAM,SAAAP,GAAC,OAAI8C,QAAQlD,MAAMI,M,OAE9ByC,aAAa6B,WAAW,UACxBC,OAAOC,SAASC,S,2KAORC,G,0FAEFpD,E,UAASJ,E,cAEcyD,UAArBC,E,EAAAA,SAAUC,E,EAAAA,OACZC,EAAOC,IAAO,IAAIC,M,SAEDtD,MAAMJ,EAAK,CAC9BiB,OAAQ,OACRW,QAAS,CACL,OAAU,mBACV,eAAgB,mBAChB,cAAgB,SAAhB,OAA0BwB,IAE9BZ,KAAMnB,KAAKyB,UAAU,CAAEa,QAAQ,GAAD,OAAKJ,EAAL,YAAeD,EAAf,aAA4BE,O,UAPxD3B,E,OAUN1B,KAAK0C,SAEmB,MAApBhB,EAASC,O,sBAAsB,IAAIH,MAAM,uB,wBAE3BE,EAASkB,O,QAArB7B,E,OACNC,aAAayC,QAAQ,SAAUvC,KAAKyB,UAAU5B,IAE9C+B,OAAOC,SAASC,S,gHAUTtE,O,wCCpOfgF,EAAOC,QAAU,IAA0B,kC,mBCA3CD,EAAOC,QAAU,IAA0B,2C,uMCsCrCC,EAAU,SAAC,GAAiE,IAA/DC,EAA8D,EAA9DA,KAAM3E,EAAwD,EAAxDA,KAAM4E,EAAkD,EAAlDA,MAErBC,EAAQ,WACV,OAAQ7E,GACJ,IAAK,QAAS,OAAO8E,IACrB,IAAK,OAAQ,OAAOC,IACpB,IAAK,UAAW,OAAOC,IACvB,IAAK,UAAW,OAAOC,KALjB,GASd,OACI,yBAAK9F,UAAS,kBAAaa,GAAQkF,QAASN,GACxC,8BAAOD,GACP,kBAAC,IAAS,CAAEE,WAKlBM,EAAiBC,IAAMC,cAG1B,CAAC,GAAI,eAOKC,EAAc,WAAO,IAAD,EACGC,qBAAWJ,GADd,mBACtBK,EADsB,KACZC,EADY,KAG7BC,qBAAU,WACN,IAAMC,EAAIC,uBAAY,WAClB,GAAIJ,EAASK,OAAS,EAAG,CACrB,IAAMC,GAAM,IAAIzB,MAAO0B,UACvBN,GAAY,SAAAO,GAAC,OAAIA,EAAEC,QAAO,gBAAG9B,EAAH,EAAGA,KAAH,OAAc2B,EAAM3B,EAAK4B,UAAY,aAEpE,KACH,OAAO,kBAAMG,aAAaP,MAC3B,IAUH,MAAO,CAAErE,IARG,SAAC0E,GAAD,OAAqBP,GAAY,SAAAU,GAAG,4BAAQA,EAAIC,OAAO,IAAnB,4BAA4BJ,GAA5B,IAA+B7B,KAAM,IAAIE,aAQ3EgC,MAPA,kBAAMZ,EAAY,KAOXb,MANP,SAAC0B,GAAD,OAAmBb,GAAY,SAAAU,GACzC,IAAMI,EAAC,YAAOJ,GAEd,OADAI,EAAEC,OAAOF,EAAO,GACTC,QAMFE,EAAWtB,EAAesB,SAExBC,EA5EE,WAAO,IAAD,EACAnB,qBAAWJ,GAAvBK,EADY,sBAEIF,IAAVV,GAFM,EAEXtD,IAFW,EAENsD,OAEb,OACI,kBAAC+B,EAAA,EAAD,CAAiBxH,UAAU,YACtBqG,EAASY,MAAM,EAAG,GAAGQ,KAAI,SAAC/G,EAAS8F,GAAV,OACtB,kBAACkB,EAAA,EAAD,CAAehF,KAAMhC,EAAQsE,KAAM2C,QAAS,KACxC,kBAAC,EAAD,eAASlC,MAAO,kBAAMA,EAAMe,KAAQ9F,UCKlDkH,EAAU1B,wBAA+D,MAElEoB,EAAWM,EAAQN,SAMnBO,EAA8B,WACvC,IAAMC,EAAU1B,qBAAWwB,GAC3B,IAAKE,EAAS,MAAM,IAAI3E,MAAM,8BAC9B,OAAO2E,GAiEEC,EAAiB,WAAO,IAAD,EACRtI,qBADQ,mBACzBuI,EADyB,KACnBC,EADmB,OAEFxI,oBAAS,GAFP,mBAEzByI,EAFyB,KAEhBC,EAFgB,OAGJ1I,oBAAS,GAHL,mBAGzB2I,EAHyB,KAGjBC,EAHiB,OAIA5I,mBAAS,GAJT,mBAIzB6I,EAJyB,KAIfC,EAJe,OAMD9I,mBAAkB,IANjB,mBAMzB+I,EANyB,KAMbC,EANa,KAO1BC,EAAWC,mBAAQ,kBAAM,YAAIH,GAAYI,MAAK,kBAAMC,KAAKC,SAAW,QAAM,CAACN,IAC3EO,EAAQb,EAAUQ,EAAWF,EARH,EASN/I,mBAAS,GATH,mBASzB0H,EATyB,KASlB6B,EATkB,KAW1BC,EAAQN,mBAAQ,WAClB,IAAMO,EAAI,IAAIC,MAEd,OADAD,EAAEE,YAAc,YACTF,IACR,IACGG,EApCc,SAACpB,GAA0D,IAAD,EACpDxI,mBAAkB,IADkC,mBACvEsJ,EADuE,KAChEN,EADgE,KAExEpC,EAAWF,IAejB,MAAO,CAAE4C,QAAO5G,IAbJ,SAACmH,GACTb,GAAS,SAAAzB,GAAG,4BAAQA,GAAR,CAAasC,OACzBjD,EAASlE,IAAI,CAAEqD,KAAK,SAAD,OAAW8D,EAAEC,MAAb,iBAAmC1I,KAAM,aAW3C2I,OARN,SAACrC,GACZsB,GAAS,SAAAzB,GACL,IAAMI,EAAC,YAAOJ,GAEd,OADAI,EAAEC,OAAOF,EAAO,GACTC,OAuBDqC,GAEdlD,qBAAU,WACN,IAAMlC,EAAS,kBAAMkE,EAAYU,EAAMS,cAEvC,OADAT,EAAMU,iBAAiB,aAActF,GAC9B,kBAAM4E,EAAMW,oBAAoB,aAAcvF,MACtD,CAAC4E,IAEJ,IAAMY,EAAI,uCAAG,WAAO7B,EAAwBe,GAA/B,mBAAAG,EAAA,yDACHY,EAAKC,MAAMC,QAAQhC,GAAQA,EAAOe,EAClCkB,EAAKF,MAAMC,QAAQhC,QAAQjG,EAAYiG,EACvCsB,EAHG,OAGCW,QAHD,IAGCA,IAAOH,EAAKA,EAAG,QAAK/H,EAE1B+H,GAAMR,GACNN,EAASc,EAAGI,QAAQZ,IAGxBb,EAAS,YAAD,OAAMqB,QAAN,IAAMA,IAAM,OATX,OAWLR,QAXK,IAWLA,OAXK,EAWLA,EAAGL,OAXE,iCAWWkB,IAAIlB,MAAMK,EAAEL,OAC3BpH,MAAK,SAAAuI,GACFnC,EAAQqB,GAERL,EAAMmB,IAAMA,EACZnB,EAAMS,YAAc,EACpBT,EAAMY,UAEPpJ,OAAM,SAAAP,GACL+H,OAAQlG,GACRiB,QAAQlD,MAAMI,MArBb,uDAwBE+I,QAxBF,IAwBEA,OAxBF,EAwBEA,EAAOY,OAxBT,4CAAH,wDAiCJQ,EAAQ,WACV,UAAIhB,QAAJ,IAAIA,OAAJ,EAAIA,EAAON,MAAM,GAAI,OAAO,WACxBc,EAAKR,EAAMN,MAAM,IACjBM,EAAMG,OAAO,IAGb,IAAMhD,EAAIW,EAAQ,EAClB,OAAI4B,EAAMrC,OAAS,IAAMF,EAAIuC,EAAMrC,QAAU0B,GAAgB,WACzDyB,EAAKd,EAAMvC,EAAIuC,EAAMrC,eADzB,EAPM,GAad,MAAO,CACHsB,KAAMA,EAAI,2BAAQA,GAAR,IAActB,OAAQuC,EAAMqB,gBAAavI,EACnD8H,OAAMU,MArBI,WACL,OAALtB,QAAK,IAALA,KAAOsB,SAoBMF,OAAMG,cAjBNzI,EAkBbmG,UAASE,SAAQD,aAAYE,YAC7BoC,QAAS,mBAAQxB,IAAUA,EAAMyB,QACjCpC,WACAe,QACAJ,QACAF,MAAOA,EAAM9B,MAAME,EAAQ,EAAGA,EAAQ,MAIjCwD,EAAa,SAAC,GAAuD,IAArD3C,EAAoD,EAApDA,KAAMe,EAA8C,EAA9CA,MAA8C,EACnClB,IAAlCgC,EADqE,EACrEA,KAAMU,EAD+D,EAC/DA,MAAOE,EADwD,EACxDA,QAAenB,EADyC,EAC/CtB,KACxB4C,EAAW5C,EAAKpH,MAAL,OAAY0I,QAAZ,IAAYA,OAAZ,EAAYA,EAAG1I,IAC1BiK,GAAY7C,EAAKiB,MASvB,OACI,0CAAQjJ,UAAW8K,IAAQ,cAAe,CAAED,cAAiB,CAAE9E,QARnD,WACR6E,EACIH,IAAWF,IACVV,IACFA,EAAK7B,EAAMe,MAKd,kBAAC,IAAD,CAAMrD,KAAOkF,GAAYH,IAAaM,IAAUC,QAK7CnD,I,iBCnMR,SAASoD,EAAU5I,EAAkBZ,GAA+B,IAAD,EAC1ChC,qBAD0C,mBAC/DyL,EAD+D,KACvDC,EADuD,OAExC1L,oBAAS,GAF+B,mBAE/D2L,EAF+D,KAEtDC,EAFsD,OAGxC5L,qBAHwC,mBAG/DiB,EAH+D,KAGtD4K,EAHsD,KAKhEhJ,EAAQC,IAAYC,OAAOf,GAYjC,OAXA8E,qBAAU,WAIN,OAHA8E,GAAW,GACXF,OAAUpJ,GAEH1B,IAAIkL,UAAalJ,EAAUC,GAAOT,MAAK,SAACC,EAAG5B,GAC9CiL,EAAUrJ,GACVwJ,EAAU,OAACpL,QAAD,IAACA,OAAD,EAACA,EAAGQ,SACd2K,GAAW,QAEhB,CAAC/I,EAAOD,IAEJ,CAAC6I,EAAQE,EAAS1K,GAOtB,SAAS8K,EAAeC,GAAsB,IAAD,EACfhM,mBAAc,IADC,mBACzCiM,EADyC,KAC7BC,EAD6B,OAElBlM,oBAAS,GAFS,mBAEzC2L,EAFyC,KAEhCC,EAFgC,OAGhB5L,mBAAmB,IAHH,mBAGzC4G,EAHyC,KAG/BC,EAH+B,KAK1CsF,EAAUjD,mBAAQ,kBAAM+C,EAAW5E,QAAO,SAAAhF,GAAC,QAAMA,OAAI,CAAC4J,IA6B5D,OA3BAnF,qBAAU,WACFqF,EAAQlF,SAAW+E,EAAU/E,QAAQ2E,GAAW,KACrD,CAACO,EAASH,IAEblF,qBAAU,WACN8E,GAAW,GACXM,EAAW,IAEX,IAAME,EAAgBJ,EAAUhE,KAAI,SAACpF,EAAUmE,GAAX,OAAiBnG,IAAIkL,UAAalJ,GACjER,MAAK,SAACC,EAAG5B,GACFA,EAAGoG,GAAY,SAAAO,GACf,IAAMO,EAAC,YAAOP,GAEd,OADAO,EAAEZ,GAAKtG,EAAEQ,QACF0G,KAEFtF,GAAG6J,GAAW,SAAAG,GACnB,IAAM1E,EAAC,YAAO0E,GAEd,OADA1E,EAAEZ,GAAK1E,EACAsF,WAKnB,OAAO,kBAAMyE,EAAc7J,SAAQ,SAAA+J,GAAC,OAAIA,UAEzC,CAACN,IAEG,CAACG,EAASR,EAAS/E,GASvB,SAAS2F,EAA6B3J,EAAkBZ,GAA+B,IAAD,EACtDwJ,EAAiB5I,EAAUZ,GAD2B,mBAClFwK,EADkF,KAC1Eb,EAD0E,KACjE1K,EADiE,KAMzF,MAAO,CAHQiI,mBAAQ,wBAAM,iBAACsD,QAAD,IAACA,OAAD,EAACA,EAAQC,eAAT,QAAoB,IAC5CtD,MAAK,SAACM,EAAGiD,GAAJ,OAAUjD,EAAEtI,GAAKuL,EAAEvL,QAAK,CAACqL,IAEnBb,EAAS1K,GAUtB,SAAS0L,EAAiC/J,EAAkBZ,EAA2C4K,GAC1G,IACMvK,EAAsB,oBAAXL,EAAwBA,EAAS4K,EAFkG,EAGnHL,EAAc3J,EAFnB,kBAAXZ,EAAsBA,OAASM,GADoG,mBAG7ImJ,EAH6I,KAGrIE,EAHqI,KAG5HtL,EAH4H,KAKpJ,OAAIsL,EAAgB,kBAAC,EAAD,MACfF,EACEpJ,EAAIA,EAAEoJ,GAAU,KADH,0BAAMlL,UAAU,cAAcF,GAAS,aAoCxD,IAAMwM,EAAU,WACnB,OAAO,kBAAC,IAAD,CAAMtM,UAAU,iBAAiB0F,KAAM6G,OAW3C,SAASC,EAAcnK,EAAkBZ,EAAyC4K,GACrF,IACMvK,EAAsB,oBAAXL,EAAwBA,EAAS4K,EAF2E,EAG5FpB,EAAU5I,EAFf,kBAAXZ,EAAsBA,OAASM,GAD6E,mBAGtHmJ,EAHsH,KAG9GE,EAH8G,KAGrGtL,EAHqG,KAK7H,OAAIsL,EAAgB,kBAAC,EAAD,MACfF,EACEpJ,EAAIA,EAAEoJ,GAAU,KADH,0BAAMlL,UAAU,cAAcF,GAAS,a,kBChJhD2M,EATF,SAACC,GAAoF,IACtFC,EAA+CD,EAA/CC,SAAU3M,EAAqC0M,EAArC1M,UAAW4M,EAA0BF,EAA1BE,KAAMC,EAAoBH,EAApBG,MAAUC,EADgD,YACtCJ,EADsC,yCAE7F,OACI,uCAAK1M,UAAS,iBAAKA,QAAL,IAAKA,IAAa,GAAlB,YAAwB4M,GAAQC,MAAK,aAAIE,SAAUH,EAAMtE,SAAU,YAAeuE,IAAaC,GACxGH,ICoDPK,EAAgB/G,IAAMC,cAGzB,CAAC,KAAM,eAEG+G,EAAY,WAAO,IAAD,EACV7G,qBAAW4G,GAAnBE,EADkB,oBAG3B,MAAO,CAAEA,OAAMzH,MADD,kBAAMyH,EAAK,SAIhB5F,EAAW0F,EAAc1F,SAEvB6F,EAxCA,WAAO,IAAD,EACE/G,qBAAW4G,GAAvBL,EADU,oBAETlH,EAAUwH,IAAVxH,MACF2H,EAAMC,iBAAO,MAUnB,OARA9G,qBAAU,WACN,IAAM+G,EAAW,SAACpN,GACI,KAAdA,EAAEqN,SAAgB9H,KAG1B,OADAhB,OAAOkF,iBAAiB,UAAW2D,GAC5B,kBAAM7I,OAAOmF,oBAAoB,UAAW0D,OAInD,oCACKX,GAAY,yBAAK5G,QAASN,EAAOzF,UAAU,YAE3C2M,GACG,uCAAK3M,UAAU,qBAAwB,CAAEoN,QACpCT,KCvCfa,EAAQ,CAACC,IAAcC,IAASC,IAAUC,IAAQC,IAAeC,KAE1DC,EAAQ,SAACrB,GAA0D,IACpEtC,EAAsBsC,EAAtBtC,IAAK4D,EAAiBtB,EAAjBsB,IAAQC,EADsD,YAC7CvB,EAD6C,iBAE9CjN,oBAAS,GAFqC,mBAEpEyO,EAFoE,KAE1DC,EAF0D,KAIrEzI,EAAOiD,mBAAQ,kBAAM6E,EAAM3E,KAAKuF,MAAMvF,KAAKC,SAAW0E,EAAM9G,WAAU,IAE5E,OAAO,kBAAC,EAAD,CAAMkG,KAAK,QAAQC,MAAK,eAAOoB,IAClC,uCACII,OAAQ,kBAAMF,GAAS,IACvBG,QAAS,kBAAMH,GAAS,IACxBI,WAAW,GACN,CAAEP,MAAK5D,UAEd8D,GAAY,kBAAC,IAAD,CAAMxI,KAAMA,MAI3B,SAAS8I,EAA4B9B,GAAsF,IACtHrK,EAAqBqK,EAArBrK,SAAUoM,EAAW/B,EAAX+B,OACV7N,EAAO8N,cAAP9N,GAER,OACI,oCACI,kBAAC+N,EAAiB,CAAEtM,WAAUoM,WAC9B,kBAAC,EAAD,CAAM7B,KAAK,UACNhM,EACK,kBAACgO,EAAD,cAAY,CAAEhO,MAAU8L,IACxB,uCAAarK,EAASwM,MAAM,aAAe,IAAM,GAAjD,IAAsDxM,KAO5E,SAASuM,EAAyBlC,GAA6D,IACnF9L,EAAyB8L,EAAzB9L,GAAIyB,EAAqBqK,EAArBrK,SAAUgK,EAAWK,EAAXL,OACtB,OAAOG,EAAU,UAAOnK,EAAP,YAAmBzB,IAAM,SAAAiG,GAAC,OACvC,oCACI,4BAAKA,EAAEiI,MACNzC,EAAOxF,OAKpB,IAAMkI,EAAS,SAAC,GAAwC,IAAtC1M,EAAqC,EAArCA,SAAqC,EAC3B5C,mBAAS,IADkB,mBAC5CqP,EAD4C,KACtCE,EADsC,KAE3CvJ,EAAUwH,IAAVxH,MASFoF,EAAWiE,EAAKpI,OAAS,EAE/B,OAAO,0BAAM1G,UAAU,SAASC,SATjB,SAACC,GACZA,EAAEE,iBACFqF,IACApF,IAAI4O,KAAK5M,EAAU,CAAEyM,SAChBrO,OAAM,SAAAP,GAAC,OAAI8C,QAAQlD,MAAMI,QAO9B,2BAAOF,UAAU,MAAMiB,MAAO6N,EAAM/N,SAAU,SAAAb,GAAC,OAAI8O,EAAQ9O,EAAEc,OAAOC,QAAQJ,KAAK,OAAOC,YAAY,SACpG,4BAAQd,UAAW8K,IAAQ,UAAW,CAAED,aAAahK,KAAK,UAA1D,YAKD,SAAS8N,EAAT,GAA+H,IAArFtM,EAAoF,EAApFA,SAAaqK,EAAuE,4BACrHwC,EAAWR,cAAf9N,GACAsM,EAASD,IAATC,KAEFuB,EAAS/B,EAAM+B,OAAS,WAC1B,MAA4B,oBAAjB/B,EAAM+B,OAA8B/B,EAAM+B,SAC9C,kBAAC,EAAW,CAAEpM,cACrB,KAEJ,OAAO+J,EAAkB/J,GAAU,SAAA4J,GAAM,OACrC,kBAAC,EAAD,CAAMW,KAAK,QACN6B,GAAU,4BAAQ1I,QAAS,kBAAMmH,EAAKuB,OACnC,kBAAC,IAAD,CAAM/I,KAAMyJ,OAEhB,wBAAInP,UAAU,QACRiM,EAAOvF,OAAS,EACZuF,EAAOxE,KAAI,gBAAGqH,EAAH,EAAGA,KAAMlO,EAAT,EAASA,GAAT,OACT,kBAAC,IAAD,CAAM8B,IAAK9B,EAAIwO,GAAE,WAAM/M,EAAN,aAAmBzB,IAChC,wBAAIZ,UAAW8K,IAAQ,CAAEoE,OAAQtO,EAAGJ,aAAe0O,KAC9CJ,OAIX,wBAAI9O,UAAU,cAAd,MAA+BqC,EAA/B,cC7FtB,IAOMgN,GAAc,SAACrH,GAAiB,IAAD,EACjBiD,EAAejD,EAAKsH,OAA7BA,EAD0B,oBAGjC,OACI,kBAAC,EAAD,CACIlF,IAAG,OAAEkF,QAAF,IAAEA,OAAF,EAAEA,EAAOC,UACZvB,IAAI,uBAKDwB,GAlBI,WAAO,IACdxH,EAASH,IAATG,KACR,OAAOA,EACD,kBAAC,GAAgBA,GACjB,kBAAC,EAAD,CAAOgG,IAAI,qBCCfyB,GAASxJ,IAAMyJ,MAAK,WAAO,IAAD,EACFjQ,mBAAiB,IADf,mBACrBkQ,EADqB,KACdC,EADc,OAEMnQ,mBAAiB,IAFvB,mBAErBoQ,EAFqB,KAEVC,EAFU,KAS5B,OACI,oCACI,0BAAM7P,SAAU,SAAAC,GACZA,EAAEE,iBAPV0P,GAAa,SAAA/D,GAAC,4BAAQ4D,GAAR,YAAkB5D,OAChC6D,EAAS,MAUD,2BAAOG,KAAK,SAAS/P,UAAU,OAAOW,QAAQ,QAC1C,8CACA,kBAAC,IAAD,CAAM+E,KAAMsK,OAGhB,2BAAOjP,SAAU,SAAAb,GAAC,aAAI0P,EAAS,YAAD,QAAC,EAAK1P,EAAEc,OAAO2O,aAAf,QAAwB,MAAiBM,UAAQ,EAACrP,GAAG,OAAOC,KAAK,OAAOqP,OAAO,YAAYC,QAAM,IAE/H,4BAAQnQ,UAAW8K,IAAQ,CAAED,SAA2B,IAAjB8E,EAAMjJ,SAAiB7F,KAAK,UAAnE,UACY8O,EAAMjJ,OAAN,UAAkBiJ,EAAMjJ,OAAxB,SAAwC,KAKxD,wBAAI1G,UAAU,aACT6P,EAAUpI,KAAI,SAAA2I,GAAC,OAAI,kBAAC,GAAD,CAAW1N,IAAK0N,EAAEtB,KAAMhL,KAAMsM,YAM5DC,GAAY,SAAC,GAA8B,IAtC/BD,EAsCGtM,EAA2B,EAA3BA,KAA2B,EACpBrE,oBAAS,GADW,mBACrC6Q,EADqC,KAC/BC,EAD+B,KAEtCzB,GAxCQsB,EAwCQtM,GAxCMgL,KAAK0B,UAAU,EAAGJ,EAAEtB,KAAK2B,YAAY,MAiDjE,OAPAlK,qBAAU,WACNgK,GAAQ,GACRlQ,IAAIqQ,OAAO,OAAQ5M,GACdrD,OAAM,SAAAP,GAAC,OAAI8C,QAAQlD,MAAMI,MACzB2B,MAAK,kBAAM0O,GAAQ,QACzB,CAACzM,IAGA,wBAAI9D,UAAW8K,IAAQ,CAAEwF,UACpBA,EACK,kBAAC,IAAD,CAAM5K,KAAMG,MACZ,kBAAC,EAAD,MAEN,8BAAOiJ,KAOZ,SAAS6B,GAA8BjE,GAAyG,IAC3IrK,EAAqCqK,EAArCrK,SAAUuO,EAA2BlE,EAA3BkE,MAAO9B,EAAoBpC,EAApBoC,KAAM+B,EAAcnE,EAAdmE,UADmH,cAEtHD,EAFsH,GAE3IE,EAF2I,KAElI/P,EAFkI,OAGtHtB,oBAAS,GAH6G,mBAG3IgP,EAH2I,KAGnIsC,EAHmI,OAKjI/E,EAAc3J,GAAxB4J,EAL2I,oBAO5I+E,EAASrI,mBAAQ,WACnB,OAAKkI,GAAc5E,EACZ,YAAIA,GAAQrD,MAAK,SAACM,EAAGiD,GAAO,IAAD,EACb,CAACjD,EAAGiD,GAAG1E,IAAIoJ,GAAWpJ,KAAI,SAAA0E,GAAC,OAAIA,GAAK,EAAI,KAD3B,mBAE9B,OAF8B,aADP,OAAOF,QAAP,IAAOA,IAAU,KAK7C,CAAC4E,EAAW5E,IAETgF,EAAM,SAACC,GACT,GAAU,WAANA,EAAgBH,GAAU,OACzB,CACDA,GAAU,GACV,IAAMI,EAAKD,EAAExK,OAAS,EAAIwK,EAAI,KAC9BnQ,EAASoQ,KAIjB,OAAO,oCACH,4BAAQlQ,MAAK,OAAE6P,QAAF,IAAEA,IAAW,GAAIlQ,GAAE,OAAEkO,QAAF,IAAEA,IAAQzM,EAAUyM,KAAI,OAAEA,QAAF,IAAEA,IAAQzM,EAAUtB,SAAU,SAAAb,GAAC,OAAI+Q,EAAI/Q,EAAEc,OAAOC,SACnG+P,EAAOtK,OAAS,GACb,oCACI,4BAAQzF,MAAM,IAAd,aAA4BoB,GAC5B,4BAAQpB,MAAM,UAAd,aAAkCoB,GACjC2O,EAAOvJ,KAAI,SAAAZ,GAAC,OACT,4BACI7G,UAAW8K,IAAQ,CAAE+F,UAAWA,GAAaA,EAAUhK,KACvDnE,IAAKmE,EAAEjG,GACPK,MAAO4F,EAAEuK,cACRvK,EAAEiI,WAMtBL,GAAU,2BAAO5N,KAAK,UAKxB,IAAMwQ,GAAmB,SAAC3E,GAAyD,IAC9ErK,EAAoBqK,EAApBrK,SAAUuO,EAAUlE,EAAVkE,MADmE,cAEzDA,EAFyD,GAE9EE,EAF8E,KAErE/P,EAFqE,OAG/DtB,mBAA4BqR,EAAQpK,OAAS,EAAIoK,EAAU,CAAC,OAHG,mBAG9E7E,EAH8E,KAGtEgF,EAHsE,KASrF,OAJA1K,qBAAU,WACNxF,EAASkL,EAAOnF,QAAO,SAAAD,GAAC,QAAMA,QAC/B,CAACoF,IAEG,yBAAKjM,UAAU,gBACjBiM,EAAOxE,KAAI,SAAC6J,EAAO9K,GAAR,OACR,kBAACmK,GAAD,eAAa7B,KAAI,UAAKzM,EAAL,MAAmBK,IAAK8D,GAAO,CAAEnE,YAAlD,CAA8DuO,MAAO,CACjEU,EAAO,SAAAC,GACH,IAAMnK,EAAC,YAAO6E,GACR/C,EAAsB,oBAAXqI,EAAwBA,EAAOD,GAASC,EAErDrI,GAAW,IAAN1C,EAASY,EAAEZ,GAAK0C,EACpB9B,EAAEC,OAAOb,EAAG,GAEjByK,EAAI7J,WAIf6E,EAAOA,EAAOvF,OAAS,IAAM,4BAAQX,QAAS,kBAAMkL,EAAI,GAAD,mBAAKhF,GAAL,CAAa,UAAvC,SASzBuF,GAAmB,SAAC,GAAgC,IAAD,MAA7BxJ,EAA6B,EAA7BA,KACvBvC,EAAUwH,IAAVxH,MADoD,EAGlChG,mBAAQ,iBAASuI,QAAT,IAASA,OAAT,EAASA,EAAMuB,aAAf,QAAwB,IAHE,mBAGrDA,EAHqD,KAG9CkI,EAH8C,OAIlChS,mBAAQ,iBAAgBuI,QAAhB,IAAgBA,OAAhB,EAAgBA,EAAMsH,aAAtB,QAA+B,MAJL,mBAIrDA,EAJqD,KAI9CoC,EAJ8C,OAK9BjS,mBAAQ,iBAAWuI,QAAX,IAAWA,OAAX,EAAWA,EAAM2J,eAAjB,QAA4B,IALN,mBAKrDA,EALqD,KAK5CC,EAL4C,KAOtDf,EAAYlI,mBAAQ,kBAAM,SAAC2G,GAAD,OAC5BqC,EAAQE,OAAM,SAAA3I,GAAC,OAAIoG,EAAMqC,QAAQG,SAAS5I,SAAK,CAACyI,IAG9CI,EAAO,CAAEJ,UAASrC,QAAO/F,SAE/B,OACI,0BAAMvJ,UAAU,SAASC,SAAU,SAAAC,GAC/BA,EAAEE,iBACFqF,IACIuC,GAAM3H,IAAI2R,IAAJ,eAAgBhK,EAAKpH,IAAMmR,GAChCtR,OAAM,SAAAP,GAAC,OAAI8C,QAAQlD,MAAMI,QAG9B,kBAAC,EAAD,CAAM0M,KAAK,SACP,2BAAOjM,QAAQ,SAAf,SACA,2BAAOX,UAAU,MAAMY,GAAG,QAAQC,KAAK,OAAOC,YAAY,QAAQG,MAAOsI,EAAOxI,SAAU,SAAAb,GAAC,OAAIuR,EAASvR,EAAEc,OAAOC,WAGrH,kBAAC,EAAD,CAAM2L,KAAK,WACP,0CACA,kBAAC,GAAD,CAAkBvK,SAAS,SAASuO,MAAO,CAACe,EAASC,MAGzD,kBAAC,EAAD,CAAMhF,KAAK,SACP,2BAAOjM,QAAQ,SAAf,SACA,kBAACgQ,GAAD,eAAatO,SAAS,QAAQuO,MAAO,CAACtB,EAAOoC,IAAe,CAAEb,gBAGlE,2BAAOhQ,KAAK,SAASb,UAAU,UAAUiB,MAAM,WAM5CwO,MC1KR,SAASwC,GAA+BhG,GAA2C,IAA9BiG,IAA6B,2DACrDzS,mBAAmB,IADkC,mBAC9EmL,EAD8E,KACpEuH,EADoE,OAE3D1S,mBAAmB,IAFwC,mBAE9E2S,EAF8E,KAEvEC,EAFuE,OAG7D5S,qBAH6D,mBAG9E6S,EAH8E,KAGxEC,EAHwE,KAK/EC,EAAM7J,mBAAQ,kBAAMsD,EAAOxE,KAAI,SAAAZ,GAAC,OAAIA,EAAEjG,QAAK,CAACqL,IAElD1F,qBAAU,WACN,IAAM+G,EAAW,SAACpN,GACVA,EAAEuS,SAAyB,KAAdvS,EAAEqN,UACfrN,EAAEE,iBACF+R,EAAY,YAAIK,IAChBH,EAAS,YAAIG,MAIrB,OADA/N,OAAOkF,iBAAiB,UAAW2D,GAC5B,kBAAM7I,OAAOmF,oBAAoB,UAAW0D,OAGvD,IAAMoF,EAAa,SAAC7L,GAChB,IAAMjG,EAAkB,kBAANiG,EAAiBA,EAAIA,EAAEjG,GACzC,OAAOgK,EAASkH,SAASlR,IAGvB+R,EAAS,SAAC/R,GACZ,IAAMuG,EAAQqL,EAAItI,QAAQtJ,GACpBgS,EAAKF,EAAW9R,GAEtB,MAAO,CACHiS,YAAa,SAAC3S,GACV,IACMkH,GADYlH,EAAE4S,UAAY5S,EAAEuS,UAAYP,EACzBE,EAAQ,GAEzBQ,GAAM1S,EAAEuS,SAAWP,EACnB9K,EAAEC,OAAOF,EAAO,GAEhBC,EAAE2L,KAAKnS,GAGNV,EAAE4S,WACHP,EAAQpL,GACRkL,EAASjL,IAGb+K,EAAY/K,IAEhB4L,UAAW,SAAC9S,GACR,IAAM+S,EAAQ/S,EAAE4S,SAEZZ,GAASe,QAAkBlR,IAATuQ,GAAoBH,GAAY,SAAAnL,GAKlD,IAJA,IAAMI,EAAC,YAAOJ,GAERkM,EAAQrK,KAAKsK,IAAIb,EAAMnL,GACvBiM,EAAQvK,KAAKwK,IAAIf,EAAMnL,GACpBX,EAAI0M,EAAO1M,GAAK4M,EAAO5M,IAAKY,EAAE2L,KAAKP,EAAIhM,IAEhD,OAAOY,MAGfkM,YAAa,SAACpT,GACV,GAAIA,EAAEqT,QAAS,CACX,IAAMnM,EAAC,YAAOgL,GACd,QAAarQ,IAATuQ,EAGA,IAFA,IAAMY,EAAQrK,KAAKsK,IAAIb,EAAMnL,GACvBiM,EAAQvK,KAAKwK,IAAIf,EAAMnL,GACpBX,EAAI0M,EAAO1M,GAAK4M,EAAO5M,IAAKY,EAAE2L,KAAKP,EAAIhM,IAEpD2L,EAAY/K,OAM5B,MAAO,CAAEwD,SAAU,kBAAMqB,EAAOnF,QAAO,SAAAD,GAAC,OAAI6L,EAAW7L,EAAEjG,QAAM8R,aAAYC,UAa/E,IAAMa,GAAY,SAAC,GAAmC,IAAjCzK,EAAgC,EAAhCA,MACTtD,EAAUwH,IAAVxH,MADyC,EAG7BuG,EAAsB,YAAnCyH,EAH0C,sBAKJxB,GAAY,OAAYwB,QAAZ,IAAYA,IAAa,IAAI,GAA9Ef,EALyC,EAKzCA,WAAYC,EAL6B,EAK7BA,OAL6B,yCAMO/H,WAAjDA,EAN0C,oBAgBjD,OAAK6I,EAGD,yBAAKzT,UAAU,oBACX,4BAAQA,UAAW8K,IAAQ,UAAW,CAAED,UAAWD,IAAa7E,QAZzD,WACX2N,QAAQC,IAAI5K,EAAMjC,QAAO,SAAAwC,GAAC,OAAIoJ,EAAWpJ,EAAE1I,OAAK6G,KAAI,SAAAO,GAAI,OACpD3H,IAAI4O,KAAK,iBAAkB,CAAEjH,KAAMA,EAAKoJ,aAAcwC,SAAUhJ,EAASwG,eAAgB,GACpF3Q,OAAM,SAAAP,GAAC,OAAI8C,QAAQlD,MAAMI,UAC/B2B,MAAK,kBAAMxB,IAAIgE,YAClBoB,MAOI,OACSsD,EAAMrC,OADf,gBAGA,4BACK+M,EAAUhM,KAAI,gBAAGqH,EAAH,EAAGA,KAAMlO,EAAT,EAASA,GAAT,OACX,sCAAI8B,IAAK9B,EAAIZ,UAAW8K,IAAQ,CAAEF,SAAU8H,EAAW9R,MAAY+R,EAAO/R,IAAMkO,QATzE,kBAAC,EAAD,OAsBrB+E,GAAQnE,gBAAK,YAAsE,IAAD,EAAlE3G,EAAkE,EAAlEA,MAAU2D,EAAwD,yBAC9EoH,EAAY7B,GAAalJ,GACvBmE,EAASD,IAATC,KAEF6G,EAAUpL,mBAAQ,uDAAU+D,EAAMqH,eAAhB,QAA2B,IAA3B,CAA+B,CACnDrO,KAAMyJ,IACN6E,QAAS,SAAAxN,GAAC,oBAAWA,EAAX,gBAA0B,IAANA,EAAU,GAAK,IAAnC,iBACV+K,OAAQ,SAAAxI,GAAK,OAAImE,EAAK,kBAAC,GAAc,CAAEnE,iBACvC,CAAC2D,EAAMqH,UAEX,GAA6B,KAAzB,iBAAChL,QAAD,IAACA,OAAD,EAACA,EAAOrC,cAAR,QAAkB,GAAU,OAAO,uBAAGmG,MAAO,CAAEE,SAAU,SAAW/M,UAAU,cAA3C,gBAEvC,IAAM4K,EAAWkJ,EAAUlJ,WAE3B,OACI,yBAAK5K,UAAU,YACX,yBAAKA,UAAU,WACT4K,EAASlE,OAAS,EAAKqN,EAAQtM,KAAI,WAA4BjB,GAAO,IAAhCd,EAA+B,EAA/BA,KAAMsO,EAAyB,EAAzBA,QAASzC,EAAgB,EAAhBA,OAC7C/L,EAA0B,kBAAZwO,EAAuBA,EAAUA,EAAQpJ,EAASlE,QAEtE,OACI,4BAAQhE,IAAK8D,EAAGxG,UAAW8K,IAAQ,CAAED,SAA8B,IAApBD,EAASlE,SAAiBX,QAAS,kBAAMwL,EAAO3G,KAC3F,kBAAC,IAAS,CAAElF,SACZ,8BAAOF,OAId,uBAAGxF,UAAU,cAAb,sBAET,yBAAKA,UAAU,SACX,6BACI,4BACA,oCACA,sCACA,oCACA,qCACA,4BACA,6BAEH+I,EAAMtB,KAAI,SAAAO,GAAI,OACX,kBAAC,GAAD,cACQ,CAAE8L,aADV,CAEIpR,IAAKsF,EAAKpH,IAAQ,CAAEoH,OAAMe,mBAc5CkL,GAAU,SAACvH,GAAqF,IAAD,EACzF1E,EAA2B0E,EAA3B1E,KAAM8L,EAAqBpH,EAArBoH,UAAW/K,EAAU2D,EAAV3D,MACjBmE,EAASD,IAATC,KACA7D,EAAUxB,IAAVwB,MAER,GAAoB,kBAATrB,EAAmB,OAAO,kBAAC,GAAD,eAAgBxG,IAAKwG,GAAU,CAAE8L,eAL2B,IAOzFxE,EAAsCtH,EAAtCsH,MAAOqC,EAA+B3J,EAA/B2J,QAASpI,EAAsBvB,EAAtBuB,MAAO7C,EAAesB,EAAftB,OAAQ9F,EAAOoH,EAAPpH,GACjCgK,EAAQ,iBAAGkJ,QAAH,IAAGA,OAAH,EAAGA,EAAWpB,WAAW9R,UAAzB,SAEd,OACI,uCAAKZ,UAAW8K,IAAQ,CAAEF,cAA1B,OAA2CkJ,QAA3C,IAA2CA,OAA3C,EAA2CA,EAAWnB,OAAO/R,IACzD,kBAAC,EAAe,CAAEoH,OAAMe,UAExB,2BAAIQ,GACJ,2BAAIoI,EAAQlK,KAAI,SAAAyB,GAAC,OACb,kBAAC,GAAD,CAAQxG,IAAKwG,EAAG1H,IAAK0H,QAEzB,2BAAG,kBAAC,GAAD,CAAO1H,IAAK8N,KACf,2BAAI5I,GAEJ,kBAAC,GAAD,CAAYhB,KAAMwO,IAAQnO,QAAS,kBAAMmH,EAAK,kBAAC,GAAqB,CAAElF,aACtE,kBAAC,GAAD,CAAYtC,KAAMyO,IAAQpO,QAAS,yBAAMsD,QAAN,IAAMA,OAAN,EAAMA,EAAOlH,IAAI6F,QAM1DoM,GAAa,SAAC,GAAuE,IAArErO,EAAoE,EAApEA,QAASL,EAA2D,EAA3DA,KAE3B,OAAO,2BAAY,CAAEK,WACjB,kBAAC,IAAS,CAAEL,WAId2O,GAAiB,SAAC,GAAsE,IAApE7S,EAAmE,EAAnEA,IAAQyM,EAA2D,uBACzF,OAAOzB,EAAkBhL,GAAK,SAAAwG,GAAI,OAAI,kBAAC,GAAD,iBAAaiG,EAAU,CAAEjG,cAG7DsM,GAAS,SAAC,GAA8B,IAAD,EAC7BrJ,EAD6B,EAA3BzJ,KACP0H,EADkC,oBAEzC,OAAOA,EAAI,kBAAC,IAAD,CAAMlJ,UAAU,iBAAiBoP,GAAE,mBAAclG,EAAEtI,KAAOsI,EAAE4F,MAAe,MAGpFyF,GAAQ,SAAC,GAA8B,IAAD,EAC5BtJ,EAD4B,EAA3BzJ,KACN0H,EADiC,oBAExC,OAAOA,EAAI,kBAAC,IAAD,CAAMlJ,UAAU,iBAAiBoP,GAAE,kBAAalG,EAAEtI,KAAOsI,EAAE4F,MAAe,MAG1E+E,MCpPTW,GAAS,SAAC,GAA2D,IAAzD1F,EAAwD,EAAxDA,KAAM6C,EAAkD,EAAlDA,QAAgB8C,EAAkC,EAAzC1L,MAAiBwG,EAAwB,EAAxBA,UAAwB,EACtD/D,EAAmBiJ,GAA5B1L,EAD+D,oBAGtE,OACI,oCACI,kBAAC,EAAD,CAAOqB,IAAKmF,EAAWvB,IAAKc,IAC5B,kBAAC,EAAD,CAAMlC,KAAK,WACN+E,EAAQlK,KAAI,SAAAyB,GAAC,OAAI,kBAAC,GAAD,CAAQxG,IAAKwG,EAAG1H,IAAK0H,QAE3C,kBAACwL,GAAa,CAAE3L,YAKtBuL,GAAS,SAAC,GACZ,OAAO9H,EADkC,EAA3BhL,KACkB,gBAAGsN,EAAH,EAAGA,KAAMlO,EAAT,EAASA,GAAT,OAC5B,kBAAC,IAAD,CAAMwO,GAAE,mBAAcxO,IAAOkO,OAQtB6F,GAJA1O,IAAMyJ,MAAK,WACtB,OAAO,kBAAClB,EAAD,CAAWC,QAAM,EAACpM,SAAS,QAAQgK,OAAQ,SAACnD,GAAD,OAAe,kBAAC,GAAWA,SCtB3E0L,GAAU3O,IAAMyJ,MAAK,WACvB,OAAO,kBAAClB,EAAD,CAAWC,QAAM,EAACpM,SAAS,SAASgK,OAAQ,SAACnD,GAAD,OAAgB,kBAAC,GAAWA,SAG7EoL,GAAS,SAAC,GAAyB,IAAvBO,EAAsB,EAAtBA,OACd,OACI,oCACI,kBAAC,EAAD,CAAMjI,KAAK,UACNiI,EAAOnO,OAAS,EACXmO,EAAOpN,KAAI,SAAAyB,GAAC,OAAI,kBAAC,GAAD,CAAOxG,IAAKwG,EAAG1H,IAAK0H,OACpC,uBAAGlJ,UAAU,cAAb,oBAOhBuU,GAAQ,SAAC,GACX,OAAO/H,EADiC,EAA3BhL,KACkB,gBAAG+N,EAAH,EAAGA,UAAWT,EAAd,EAAcA,KAAMgG,EAApB,EAAoBA,QAAS/L,EAA7B,EAA6BA,MAAOnI,EAApC,EAAoCA,GAApC,OAC3B,kBAAC,IAAD,CAAMwO,GAAE,kBAAaxO,IACjB,4BAAKkO,EAAL,aAAqBgG,EAArB,KACA,kBAAC,EAAD,CACI1K,IAAKmF,EACLvB,IAAI,UAER,+BACI,+BACMjF,EAAMrC,OAAS,EACXqC,EAAMtB,KAAI,SAAAsN,GAAC,OAAI,kBAAC,GAAD,CAASrS,IAAKqS,EAAGvT,IAAKuT,OACrC,4BAAI,wBAAI/U,UAAU,cAAd,wBAQxBiU,GAAU,SAAC,GAA8B,IAAD,EAC3BhJ,EAD2B,EAA3BzJ,KACRwG,EADmC,oBAG1C,OACI,4BACKA,EACK,oCACE,4BAAKA,EAAK8G,MACV,4BAAK9G,EAAKtB,SAEZ,wBAAIsO,QAAS,GAAG,kBAAC,EAAD,SAMnBJ,M,SCvBAK,GA5BH,WACR,IAAMC,EAAOC,cAAcC,SAErBC,EAAQ,CACV,CAAElU,KAAM,SAAUqE,KAAM,QAASE,KAAMgI,KACvC,CAAEvM,KAAM,aAAcqE,KAAM,YAAaE,KAAMyO,KAC/C,CAAEhT,KAAM,UAAWqE,KAAM,SAAUE,KAAMoI,KACzC,CAAE3M,KAAM,WAAYqE,KAAM,UAAWE,KAAM4P,KAC3C,CAAEnU,KAAM,UAAWqE,KAAM,SAAUE,KAAMsK,KACzC,CAAE7O,KAAM,UAAWqE,KAAM,SAAUE,KAAM6P,MAG7C,OACI,6BACI,4BACKF,EAAM5N,KAAI,gBAAGjC,EAAH,EAAGA,KAAMrE,EAAT,EAASA,KAAMuE,EAAf,EAAeA,KAAf,OACP,kBAAC,IAAD,CAAMhD,IAAKvB,EAAMiO,GAAIjO,GACjB,wBAAInB,UAAW8K,IAAQ,CAAEoE,OAAQgG,IAAS/T,KACtC,8BAAOqE,GACP,kBAAC,IAAS,CAAEE,iBCpB3B8P,GAAmB,CAAEC,MAAO,QAEnCC,GAAkBxP,wBACpB,CAACsP,GAAkB,eA0ChB,IAAMlO,GAAWoO,GAAgBpO,SAEzBqO,GAtCE,WAAO,IAAD,EACKvP,qBAAWsP,IAA1BE,EADU,oBAGbC,EAAqC,CACvC,CAAC,OAAQC,KACT,CAAC,QAASC,KACV,CAAC,MAAOC,MAGZ,OAAO,yBAAKhW,UAAU,YAElB,wCAEA,4BACK6V,EAAOpO,KAAI,mCAAEgO,EAAF,KAAS/P,EAAT,YACR,4BAAQhD,IAAK+S,EAAOzV,UAAU,cAAc+F,QAAS,kBAAM6P,GAAY,SAAAtM,GAAC,kCAAUA,GAAV,IAAamM,eACjF,kBAAC,IAAS,CAAE/P,gBCpB1B0O,GAAa,SAAC1H,GAAmH,IAC3HE,EAA0CF,EAA1CE,KAAMlH,EAAoCgH,EAApChH,KAAMmF,EAA8B6B,EAA9B7B,SAAU9E,EAAoB2G,EAApB3G,QAASmJ,EAAWxC,EAAXwC,OACvC,OACI,kBAAC,EAAD,eAAMlP,UAAW8K,IAAQ,cAAe,CAAED,SAAUA,IAAa9E,EAASmJ,WAAWtC,KAAI,OAAEA,QAAF,IAAEA,IAAQ,IAAQ,CAAE7G,YACzG,kBAAC,IAAS,CAAEL,WA4BlBuQ,GAAQ,WAAO,IAAD,IACSpO,IAAjBkB,EADQ,EACRA,MAAOM,EADC,EACDA,MAET6M,EAAU,CACZ,CAAC,QAAD,iBAAU7M,QAAV,IAAUA,OAAV,EAAUA,EAAON,aAAjB,QAA0B,IAC1B,CAAC,OAAQA,IACXjC,QAAO,uCAAaJ,OAAS,KAE/B,OACI,yBAAK1G,UAAU,gBACVkW,EAAQzO,KAAI,mCAAE0O,EAAF,KAAUpN,EAAV,YACT,kBAAC,IAAMqN,SAAP,CAAgB1T,IAAKyT,GACjB,2BAAIA,GACJ,wBAAIzT,IAAKyT,GACJpN,EAAMtB,KAAI,WAAgBjB,GAAhB,IAAG+C,EAAH,EAAGA,MAAO3I,EAAV,EAAUA,GAAV,OACP,wBAAI8B,IAAG,UAAK9B,EAAL,YAAW4F,IAAM+C,aAS9C8M,GAAY,SAACC,GACf,IAAMC,EAAU1N,KAAKuF,MAAMkI,EAAO,IAC5BE,EAAUF,EAAiB,GAAVC,EACvB,MAAM,GAAN,OAAUA,EAAV,YAAqBC,EAAQC,QAAQ,GAAGC,SAAS,EAAG,OAGlDC,GAAW,SAAC3O,GAAwC,IAC9CuB,EAAqCvB,EAArCuB,MAAOoI,EAA8B3J,EAA9B2J,QAASjL,EAAqBsB,EAArBtB,OAAQ4B,EAAaN,EAAbM,SAEhC,OACI,kBAAC,EAAD,CAAMsE,KAAK,QACP,4BAAKrD,GACL,kCAAIoI,QAAJ,IAAIA,OAAJ,EAAIA,EAASlK,KAAI,SAAAyB,GAAC,OAAI,kBAAC,GAAD,CAAQxG,IAAKwG,EAAG1H,IAAK0H,QAC3C,yBAAKlJ,UAAU,iBACX,8BAAOqW,GAAU/N,IACjB,kCAAQ+N,GAAU3P,EAAS4B,IAC3B,yBAAKuE,MAAO,CAAE+J,MAAM,GAAD,OAAKtO,EAAW5B,EAAS,IAAzB,WAM7B4N,GAAS,SAAC,GAA8B,IAAD,EAC7BrJ,EAD6B,EAA3BzJ,KACP0H,EADkC,oBAEzC,OAAOA,EAAI,8BAAOA,EAAE4F,MAAe,MAIjC+H,GAAS,WAAO,IAAD,EZlDI,WACrB,IAAM/O,EAAU1B,qBAAWwB,GAC3B,IAAKE,EAAS,MAAM,IAAI3E,MAAM,8BAFH,IAGnB8F,EAAUnB,EAAVmB,MAHmB,EAKLxJ,mBAAS,IALJ,mBAKpBqX,EALoB,KAKZ7F,EALY,OAMOxR,mBAASqX,GANhB,mBAMpBC,EANoB,KAMPC,EANO,KAQrBC,EAAY,SAAC/F,GACf,IAAMgG,EAAUrO,KAAKsK,IAAI,EAAGtK,KAAKwK,IAAI,EAAGnC,IACxCD,EAAIiG,GACJjO,EAAM6N,OAASI,GAGnB3Q,qBAAU,WACN,IAAMlC,EAAS,kBAAM4M,GAAI,SAAAC,GACrB,OAAIjI,EAAM6N,SAAW5F,EAAUjI,EAAM6N,OAC9B5F,MAGX,OADAjI,EAAMU,iBAAiB,eAAgBtF,GAChC,kBAAM4E,EAAMW,oBAAoB,eAAgBvF,MACxD,CAAC4E,IAEJ1C,qBAAU,WACN0C,EAAM6N,OAASA,IAChB,CAACA,EAAQ7N,IAWZ,MAAO,CAAE6N,SAAQG,YAAWE,aATP,WACbL,EAAS,GACTE,EAAWF,GACXG,EAAU,IAEVA,EAAUF,KYmB0BK,GAApCN,EADS,EACTA,OAAQG,EADC,EACDA,UAAWE,EADV,EACUA,aAErBzR,EAAkB,IAAXoR,EACPO,IACAP,EAAS,GACLQ,IACAC,IAEJC,EAAS,SAACtX,GACZ,IAAMuX,EAAIvX,EAAEwX,cAAcC,YACpBC,EAAI1X,EAAEwX,cAAcG,wBAAwBC,KAC5CC,EAAI7X,EAAE8X,QAAUJ,EAEtBX,EADUc,EAAIN,IAIlB,OACI,kBAAC,EAAD,CAAM7K,KAAK,UACP,kBAAC,GAAD,cAAgB,CAAElH,QAAlB,CAA0BK,QAASoR,KACnC,yBAAKnX,UAAU,MAAM+F,QAASyR,EAAQlE,YAAa,SAAApT,GAC3CA,EAAEqT,QAAU,GAAGiE,EAAOtX,KAE1B,yBAAK2M,MAAO,CAAE+J,MAAM,GAAD,OAAc,IAATE,EAAL,WAMpBmB,GAvGA,WAAO,IAAD,IACsGpQ,IAA/GG,EADS,EACTA,KAAMM,EADG,EACHA,SAAUuB,EADP,EACOA,KAAMU,EADb,EACaA,MAAOE,EADpB,EACoBA,QAAS1B,EAD7B,EAC6BA,MAAOM,EADpC,EACoCA,MAAOmB,EAD3C,EAC2CA,SAAUH,EADrD,EACqDA,KAAMnC,EAD3D,EAC2DA,QAASC,EADpE,EACoEA,WAAYC,EADhF,EACgFA,OAAQC,EADxF,EACwFA,UACjG6E,EAASD,IAATC,KAER,OACI,kBAAC,EAAD,CAAMN,KAAK,UACN5E,GAAQ,kBAAC,GAAD,iBAAcA,EAAU,CAAEM,cAEnC,kBAAC,GAAD,CAAYvC,QAASyE,EAAU9E,KAAMwS,IAAgBtL,KAAK,aAC1D,kBAAC,GAAD,CAAY7G,QAASsE,EAAM3E,KAAMyS,IAAevL,KAAK,SACrD,kBAAC,GAAD,CAAY7G,QAAS0E,IAAYF,EAAQ,kBAAMV,KAAQnE,KAAM+E,IAAYM,IAAUC,IAAQ4B,KAAK,SAChG,kBAAC,GAAD,CAAYsC,OAAQhH,EAASnC,QAAS,kBAAMoC,GAAW,SAAAgE,GAAC,OAAKA,MAAIzG,KAAM0S,IAAUxL,KAAK,YACtF,kBAAC,GAAD,CAAYsC,OAAQ9G,EAAQrC,QAAS,kBAAMsC,GAAU,SAAA8D,GAAC,OAAKA,MAAIzG,KAAM2S,IAAWzL,KAAK,WACrF,kBAAC,GAAD,CAAY/B,SAAU9B,EAAMrC,QAAN,iBAAgB2C,QAAhB,IAAgBA,OAAhB,EAAgBA,EAAON,MAAMrC,cAA7B,QAAuC,KAAO,EAAGhB,KAAMyO,IAAQvH,KAAK,QAAQ7G,QAAS,kBAAMmH,EAAK,kBAAC,GAAD,UACtH,kBAAC,GAAD,CAAYxH,KAAM4S,IAAO1L,KAAK,WAAW7G,QAAS,kBAAMmH,EAAK,kBAAC,GAAD,UAE7D,kBAAC,GAAD,QC5BNsG,GAAY,SAAC,GAAkD,IAAhD+E,EAA+C,EAA/CA,gBAAiBnH,EAA8B,EAA9BA,aAE1B3L,EAAUwH,IAAVxH,MAFwD,EAIzCuG,EAAkB,QAJuB,mBAIzD2H,EAJyD,KAIpDvI,EAJoD,KAK1DrC,EAAQJ,mBAAQ,yCAAMgL,QAAN,IAAMA,OAAN,EAAMA,EAAK7M,QAAO,SAAAwC,GAAC,OAJvB,SAACA,GAAD,OAAciP,EAAgBzG,SAASxI,EAAE8H,cAIboH,CAAUlP,aAAlC,QAAyC,KAAI,CAACqK,IALJ,EAOvB1B,GAAoBlJ,GAArD2J,EAPwD,EAOxDA,WAAYC,EAP4C,EAO5CA,OAAQ/H,EAPoC,EAOpCA,SAU5B,OAAIQ,EAAgB,kBAAC,EAAD,MAGhB,yBAAKpL,UAAU,oBACX,4BAAQA,UAAU,UAAU+F,QAZrB,WACX,IAAM0S,EAAW7N,IAAWnD,KAAI,SAAA6B,GAAC,OAAIA,EAAE8H,gBACvC/Q,IAAI2R,IAAIZ,EAAc,CAClBmH,gBAAgB,GAAD,mBAAMA,GAAN,YAA0BE,MAC1ChY,OAAM,SAAAP,GAAC,OAAI8C,QAAQlD,MAAMI,MAC5BuF,MAOI,4BACA,4BACKsD,EAAMtB,KAAI,gBAAG8B,EAAH,EAAGA,MAAO3I,EAAV,EAAUA,GAAV,OACP,sCAAI8B,IAAK9B,EAAIZ,UAAW8K,IAAQ,CAAEF,SAAU8H,EAAW9R,MAAY+R,EAAO/R,IAAM2I,SAO9FiL,GAAS,SAACZ,GAAyB,IAAD,EAEpBpI,EADsBoI,EAA9B2E,iBACDxP,EAF6B,oBAG5BmE,EAASD,IAATC,KAMR,OAAO,oCACH,4BAAQnH,QAAS,kBAAMmH,EAAK,kBAAC,GAAc0G,MACvC,kBAAC,IAAD,CAAMlO,KAAMyJ,OAGhB,kBAACuF,GAAD,cAAc,CAAE3L,SAAhB,CAAyBgL,QAAS,CAAC,CAC/BrO,KAAMgT,IACN1E,QAAS,SAAAxN,GAAC,uBAAcA,EAAd,gBAA6B,IAANA,EAAU,GAAK,MAChD+K,OAZO,SAACxI,YAyBL4P,GARG1S,IAAMyJ,MAAK,WACzB,OAAO,kBAAClB,EAAD,CACHC,QAAQ,EACRpM,SAAS,WACTgK,OAAQ,SAACuM,GAAD,OAAkB,kBAAC,GAAWA,SCxC/BC,GArBE,WAAO,IACR3J,EAAWR,cAAf9N,GAER,OAAOwL,EAA0B,YAAY,SAAAqH,GAAS,OAClD,kBAAC,EAAD,CAAM7G,KAAK,aACL6G,EAAU/M,OAAS,EACf,wBAAI1G,UAAU,QACXyT,EAAUhM,KAAI,gBAAG7G,EAAH,EAAGA,GAAIkO,EAAP,EAAOA,KAAP,OACX,kBAAC,IAAD,CAAMpM,IAAK9B,EAAIwO,GAAE,qBAAgBxO,IAC7B,wBAAIZ,UAAW8K,IAAQ,CAAEoE,OAAQtO,EAAGJ,aAAe0O,KAC9CJ,QAKf,uBAAG9O,UAAU,cAAb,yB,kBClBZ8Y,GAAY,CACd,iBACA,wBACA,wBACA,eACA,sBACA,gBACA,sBACA,aACA,kBACA,SACA,WACA,4BACA,yBACA,qBACA,4BACA,sBACA,kBACA,mBACA,sBACA,iBACA,qBACA,UACA,eACA,oBACA,6BACA,2BACA,+BACA,sBACA,kBACA,gBACA,oBACA,OACA,SACA,0BACA,mCACA,sBACA,oBACA,4BACA,uBACA,0BACA,mBACA,iBACA,iBACA,YACA,cACA,mBACA,+BACA,aACA,yBACA,iBACA,sBACA,WACA,gBACA,QACA,QACA,qBACA,8BACA,qBACA,qBACA,qBACA,wBACA,uBACA,kBACA,mBACA,iBACA,UAGEC,GAAc,CAChB,gBACA,eACA,kBACA,SACA,8BACA,iBACA,kBACA,wBACA,qBACA,YACA,iBACA,gBACA,QACA,eACA,eACA,gBACA,eACA,SACA,+BACA,eACA,iBACA,gBACA,cACA,eACA,gBACA,SACA,gBACA,YACA,QACA,cACA,aACA,gBACA,kBACA,QACA,WACA,YACA,eACA,cACA,gBACA,YACA,kBACA,YACA,4BACA,gBACA,UACA,eACA,oBACA,2BACA,QACA,cAQJ,SAASC,GAASC,EAAYzS,GAC1B,OAAOyS,EAAMrQ,MAAK,SAACM,EAAGiD,GAAJ,OAAUtD,KAAKC,SAAW,MAAK7B,MAAM,EAAG4B,KAAKsK,IAAI8F,EAAMvS,OAAQF,IAcrF,IAuHe0S,GAFA,I,+FAtGNC,GACD,MAAO,K,8BAGHA,GACJ,OAAOH,GAAMD,GAAaI,GAAO1R,KAAI,SAAAqH,GAAI,MAAK,CAAEA,OAAMjO,KAAM,U,6BAGzD8Q,GACH,IAAMyH,EAAYzH,EAAQlK,KAAI,SAAAyB,GAAC,OAAIA,EAAEkI,gBACrC,OAAO,SAAC+H,GAAD,OAAmBH,GAAMF,GAAWK,GAAO1R,KAAI,SAAAqH,GAAI,MAAK,CAC3DA,OACA6C,QAASqH,GAAMI,EAAW,GAC1BtE,QA3BF,GAAN,OAAU,KAAOjM,KAAKuF,MAAsB,GAAhBvF,KAA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","file":"static/js/main.72754e7f.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport API from '../api/Api';\nimport { Link } from 'react-router-dom';\n\n/**\n * @param string The string to encode\n * @returns base64 kodierter String, der username und password enthält. wird an Server geschickt\n */\nfunction base64(string: string) {\n    return new Buffer(string).toString('base64');\n}\n\n/**\n * Login-Formular\n * On Submit werden die Nutzerdaten als base64 über die API übergeben\n */\nconst Login = () => {\n\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [error, setError] = useState<string | null>(null);\n\n    return (\n        <div className='user-login'>\n            <form onSubmit={e => {\n                e.preventDefault()\n                API.login(base64(`${username}:${password}`))\n                    .catch(e => setError(e.message))\n            }}>\n\n                <h1>Login</h1>\n\n                {error && <p className='error'>{error}</p>}\n\n                <div>\n                    <label htmlFor='username'>Username</label>\n                    <input\n                        id='username'\n                        type='text'\n                        placeholder='Username'\n                        onChange={e => setUsername(e.target.value)}\n                        value={username}\n                        required\n                    />\n                </div>\n\n                <div>\n                    <label htmlFor='password'>Password</label>\n                    <input\n                        id='password'\n                        type='password'\n                        placeholder='Password'\n                        onChange={e => setPassword(e.target.value)}\n                        value={password}\n                        required\n                    />\n                </div>\n\n                <button type='submit'>Login</button>\n\n                <a href={`https://oss.anjomro.de/register/`}>Register</a>\n\n            </form>\n\n        </div>\n\n\n    );\n}\nexport default Login;\n\n","export const DEV = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\n\n//const BASE_URL = DEV ? 'https://de0.win' : '';\nconst BASE_URL = '';\nexport const API_URL = `${BASE_URL}/api/v1`;","import querystring, { ParsedUrlQueryInput } from 'querystring';\nimport { API_URL } from '../config';\nimport format from 'dateformat';\nimport { IApiKey } from './Models'\n\n/**\n * Replaced once we know the format the data will be sent by the server\n */\ntype Response<O> = O;\n\n\ninterface IObserver<O> {\n    url: string;\n    params?: ParsedUrlQueryInput | string;\n    callback: (result?: O, error?: Error) => unknown;\n}\n\ntype Method = 'post' | 'delete' | 'put' | 'get';\nclass Api {\n\n    private observers: Set<IObserver<any>> = new Set();\n\n    call<O>(observer: IObserver<O>) {\n        const { url, params, callback } = observer;\n        this.fetch<O>(url, params)\n            .then(r => callback(r))\n            .catch(e => callback(undefined, e));\n    }\n\n    /**\n     * Update all current subscribers\n     */\n    update() {\n        this.observers.forEach(o => this.call(o));\n    }\n\n    /**\n     * Subscibe to the current url\n     * Will be updated every time a non GET request is retrieved\n     * @param url The api url\n     * @param params Optional query params\n     */\n    subscribe<O>(url: string, params?: ParsedUrlQueryInput | string) {\n        return {\n            then: (callback: (result?: O, error?: Error) => unknown) => {\n                const o = { url, params, callback };\n                this.observers.add(o);\n                this.call(o);\n                return () => {\n                    this.observers.delete(o);\n                }\n            }\n        }\n    }\n\n    /**\n     * Sent a GET request\n     * @param endpoint The api url\n     * @param params Optional query params\n     */\n    async fetch<O>(endpoint: string, params?: ParsedUrlQueryInput | string) {\n        const query = typeof params === 'string' ? params : querystring.encode(params ?? {});\n        return this.method<O>('get', `${endpoint}/?${query}`);\n    }\n\n    /**\n     * Retrieves the saved api key\n     */\n    private getApiKey(): IApiKey | null {\n        const key = localStorage.getItem('apikey');\n        if (key) return JSON.parse(key);\n        return null;\n    }\n\n    /**\n     * Tests if the API is reachable with the current saved api key if present\n     */\n    public async isLoggedIn() {\n        if (!this.getApiKey()) return false;\n\n        return this.fetch('artist')\n            .then(() => true)\n            .catch(e => {\n                console.log(e);\n                //localStorage.removeItem('apikey');\n                return false;\n            });\n    }\n\n    /**\n     * Fetch an audio from the api\n     * @param url the audio endpoint\n     * @returns the blob url\n     */\n    public async audio(url: string) {\n        const apiKey = this.getApiKey();\n        if (!apiKey) throw new Error('Not logged in');\n\n        const response = await fetch(`/${url}`, {\n            headers: {\n                'Authorization': apiKey.key,\n            }\n        });\n\n        if (response.status !== 200) throw new Error(response.statusText);\n\n        const buffer = await response.arrayBuffer();\n\n        const blob = new Blob([buffer], { type: 'audio/*' })\n        return URL.createObjectURL(blob);\n\n    }\n\n    /**\n     * Uploads the file to the api\n     * @param endpoint The api url\n     * @param file The file object\n     * @param method The HTML method\n     */\n    async upload(endpoint: string, file: File, method: Method = 'post') {\n        const apiKey = this.getApiKey();\n        if (!apiKey) throw new Error('Not logged in');\n\n        let url = endpoint;\n        if (!url.startsWith(API_URL)) url = `${API_URL}/${url}`\n        url += '/';\n\n        const body = new FormData()\n        body.append('audio', file)\n\n        return await fetch(url, {\n            method: method.toUpperCase(),\n            headers: {\n                'Accept': 'application/json',\n                //'Content-Type': 'application/json',\n                'Authorization': apiKey.key,\n            },\n            body,\n        });\n    }\n\n    private async method<O>(method: Method, endpoint: string, args?: any, update = true) {\n        const apiKey = this.getApiKey();\n        if (!apiKey) throw new Error('Not logged in');\n\n        let url = endpoint;\n        if (!url.startsWith(API_URL)) url = `${API_URL}/${url}`\n        if (method !== 'get') url += '/';\n\n        const response = await fetch(url, {\n            method: method.toUpperCase(),\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json',\n                'Authorization': apiKey.key,\n            },\n            body: args ? JSON.stringify(args) : undefined,\n        });\n\n        if (update && method !== 'get') this.update();\n\n        if (response.status === 200)\n            return response.json() as Promise<Response<O>>;\n        else\n            throw new Error('Not logged in');\n\n    }\n\n    async post<O = string>(url: string, args: any = {}, update = true) {\n        return this.method<O>('post', url, args, update);\n    }\n\n    async put<O = string>(url: string, args: any = {}, update = true) {\n        return this.method<O>('put', url, args, update);\n    }\n\n    async delete<O = string>(url: string, args: any = {}, update = true) {\n        return this.method<O>('delete', url, args, update);\n    }\n\n    async logout() {\n        const apiKey = this.getApiKey();\n\n        if (apiKey) await this.delete(`apikey/${apiKey.id}`)\n            .catch(e => console.error(e))\n\n        localStorage.removeItem('apikey');\n        window.location.reload();\n    }\n\n    /**\n     * Retrieves a new api key from the api and saves it\n     * @param base64 The encoded username and password\n     */\n    async login(base64: string) {\n\n        const url = `${API_URL}/apikey/`;\n\n        const { platform, vendor } = navigator;\n        const date = format(new Date());\n\n        const response = await fetch(url, {\n            method: 'POST',\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json',\n                'Authorization': `Basic ${base64}`,\n            },\n            body: JSON.stringify({ purpose: `${vendor} ${platform}, ${date}` }),\n        });\n\n        this.update();\n\n        if (response.status !== 201) throw new Error('Invalid credentials');\n\n        const key = await response.json()\n        localStorage.setItem('apikey', JSON.stringify(key));\n\n        window.location.reload();\n\n    }\n\n}\n\n\n\nconst API = new Api();\n\nexport default API;","module.exports = __webpack_public_path__ + \"static/media/test.5aa714da.mp3\";","module.exports = __webpack_public_path__ + \"static/media/example-cover.b2e600a7.jpg\";","import { faBomb, faCheck, faExclamationTriangle, faInfoCircle } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport React, { Dispatch, SetStateAction, useContext, useEffect } from 'react';\nimport { CSSTransition, TransitionGroup } from 'react-transition-group';\nimport { setInterval } from 'timers';\n\ninterface MessageProps {\n    type: 'info' | 'success' | 'error' | 'warning';\n    text: string;\n}\n\nexport type IMessage = MessageProps & { date: Date };\n\n/**\n * The message sidebar\n * Currently not working because of an React issue with transitions\n */\nconst Messages = () => {\n    const [messages] = useContext(MessageContext);\n    const { add, close } = useMessages();\n\n    return (\n        <TransitionGroup className='messages'>\n            {messages.slice(0, 4).map((message, i) =>\n                <CSSTransition key={+message.date} timeout={400}>\n                    <Message close={() => close(i)} {...message} />\n                </CSSTransition>\n            )}\n        </TransitionGroup>\n    )\n}\n\n/**\n * \n * @param param0.text The text to display\n * @param param0.type The message type, for example 'info' or 'error'\n * @param param0.close The function to clear the message\n */\nconst Message = ({ text, type, close }: MessageProps & { close: () => void }) => {\n\n    const icon = (() => {\n        switch (type) {\n            case 'error': return faBomb;\n            case 'info': return faInfoCircle;\n            case 'success': return faCheck;\n            case 'warning': return faExclamationTriangle;\n        }\n    })();\n\n    return (\n        <div className={`message ${type}`} onClick={close}>\n            <span>{text}</span>\n            <Icon {...{ icon }} />\n        </div>\n    )\n}\n\nconst MessageContext = React.createContext<[\n    IMessage[],\n    Dispatch<SetStateAction<IMessage[]>>,\n]>([[], () => { }]);\n\n/**\n * React hook to manage messages\n * \n * @returns { add, clear, close } Functions to add or close a specific message or clear all\n */\nexport const useMessages = () => {\n    const [messages, setMessages] = useContext(MessageContext);\n\n    useEffect(() => {\n        const i = setInterval(() => {\n            if (messages.length > 0) {\n                const now = new Date().getTime();\n                setMessages(m => m.filter(({ date }) => now - date.getTime() < 4000))\n            }\n        }, 1000);\n        return () => clearTimeout(i);\n    }, [])\n\n    const add = (m: MessageProps) => setMessages(old => [...old.slice(-4), { ...m, date: new Date() }]);\n    const clear = () => setMessages([]);\n    const close = (index: number) => setMessages(old => {\n        const n = [...old];\n        n.splice(index, 1);\n        return n;\n    })\n\n    return { add, clear, close };\n}\n\nexport const Provider = MessageContext.Provider;\n\nexport default Messages;","import { faPause, faPlay } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon as Icon } from \"@fortawesome/react-fontawesome\";\nimport classes from 'classnames';\nimport React, { createContext, Dispatch, SetStateAction, useContext, useEffect, useMemo, useState } from \"react\";\nimport { useMessages } from \"../components/Message\";\nimport Api from \"./Api\";\nimport { ISong } from \"./Models\";\n\nexport interface IQueue {\n    songs: ISong[];\n    add: (s: ISong) => void;\n    remove: (i: number) => void;\n}\n\ninterface PlayerData {\n    song?: ISong;\n    play: (song?: ISong | ISong[], songs?: ISong[]) => void;\n    pause: () => void;\n    next?: () => void,\n    previous?: () => void,\n    position: number;\n    shuffle: boolean;\n    repeat: boolean;\n    setShuffle: Dispatch<SetStateAction<boolean>>;\n    setRepeat: Dispatch<SetStateAction<boolean>>;\n    playing: () => boolean;\n    queue?: IQueue;\n    songs: ISong[];\n}\n\nconst Context = createContext<PlayerData & { audio: HTMLAudioElement } | null>(null);\n\nexport const Provider = Context.Provider;\n\n/**\n * React hook to access the apps player\n * @returns the player object\n */\nexport const usePlayer: () => PlayerData = () => {\n    const context = useContext(Context);\n    if (!context) throw new Error('There is no player defined');\n    return context;\n}\n\n/**\n * Can be used anywhere to access and modify volume\n */\nexport const useVolume = () => {\n    const context = useContext(Context);\n    if (!context) throw new Error('There is no player defined');\n    const { audio } = context;\n\n    const [volume, set] = useState(0.4);\n    const [saveVolumed, saveVolume] = useState(volume);\n\n    const setVolume = (v: number) => {\n        const clamped = Math.min(1, Math.max(0, v));\n        set(clamped);\n        audio.volume = clamped;\n    }\n\n    useEffect(() => {\n        const update = () => set(v => {\n            if (audio.volume !== v) return audio.volume;\n            return v;\n        });\n        audio.addEventListener('volumechange', update);\n        return () => audio.removeEventListener('volumechange', update);\n    }, [audio]);\n\n    useEffect(() => {\n        audio.volume = volume;\n    }, [volume, audio]);\n\n    const toggleVolume = () => {\n        if (volume > 0) {\n            saveVolume(volume);\n            setVolume(0);\n        } else {\n            setVolume(saveVolumed);\n        }\n    }\n\n    return { volume, setVolume, toggleVolume };\n}\n\nexport const useQueue = (setSong: Dispatch<SetStateAction<ISong | undefined>>) => {\n    const [songs, setSongs] = useState<ISong[]>([]);\n    const messages = useMessages();\n\n    const add = (s: ISong) => {\n        setSongs(old => [...old, s]);\n        messages.add({ text: `Added ${s.title} to the queue`, type: 'success' });\n    }\n\n    const remove = (index: number) => {\n        setSongs(old => {\n            const n = [...old]\n            n.splice(index, 1);\n            return n;\n        })\n    }\n\n    return { songs, add, remove } as IQueue;\n}\n\nexport const useCreateAudio = () => {\n    const [song, setSong] = useState<ISong>();\n    const [shuffle, setShuffle] = useState(false);\n    const [repeat, setRepeat] = useState(true);\n    const [position, setPosition] = useState(0);\n\n    const [unshuffled, setSongs] = useState<ISong[]>([]);\n    const shuffled = useMemo(() => [...unshuffled].sort(() => Math.random() - 0.5), [unshuffled]);\n    const songs = shuffle ? shuffled : unshuffled;\n    const [index, setIndex] = useState(0);\n\n    const audio = useMemo(() => {\n        const a = new Audio()\n        a.crossOrigin = 'anonymous';\n        return a;\n    }, []);\n    const queue = useQueue(setSong) as IQueue | undefined;\n\n    useEffect(() => {\n        const update = () => setPosition(audio.currentTime);\n        audio.addEventListener('timeupdate', update);\n        return () => audio.removeEventListener('timeupdate', update);\n    }, [audio])\n\n    const play = async (song?: ISong | ISong[], songs?: ISong[]) => {\n        const ss = Array.isArray(song) ? song : songs;\n        const s1 = Array.isArray(song) ? undefined : song;\n        const s = s1 ?? (ss ? ss[0] : undefined);\n\n        if (ss && s) {\n            setIndex(ss.indexOf(s));\n        }\n\n        setSongs([...(ss ?? [])]);\n\n        if (s?.audio) await Api.audio(s.audio)\n            .then(src => {\n                setSong(s);\n\n                audio.src = src;\n                audio.currentTime = 0;\n                audio.play();\n\n            }).catch(e => {\n                setSong(undefined);\n                console.error(e)\n            });\n\n        else await audio?.play();\n    }\n\n    const pause = () => {\n        audio?.pause();\n    }\n\n    const previous = undefined;\n\n    const next = (() => {\n        if (queue?.songs[0]) return () => {\n            play(queue.songs[0]);\n            queue.remove(0);\n        }\n        else {\n            const i = index + 1;\n            if (songs.length > 0 && (i < songs.length || repeat)) return () => {\n                play(songs[i % songs.length]);\n            };\n        }\n    })();\n\n    return {\n        song: song ? { ...song, length: audio.duration } : undefined,\n        play, pause, next, previous,\n        shuffle, repeat, setShuffle, setRepeat,\n        playing: () => !!audio && !audio.paused,\n        position,\n        queue,\n        audio,\n        songs: songs.slice(index + 1, index + 11),\n    };\n}\n\nexport const SongButton = ({ song, songs }: { song: ISong, songs?: ISong[] }) => {\n    const { play, pause, playing, song: s } = usePlayer();\n    const selected = song.id === s?.id;\n    const disabled = !song.audio;\n\n    const onClick = () => {\n        if (selected) {\n            if (playing()) pause();\n            else play();\n        } else play(song, songs);\n    }\n\n    return (\n        <button className={classes('song-button', { disabled })} {...{ onClick }}>\n            <Icon icon={(selected && playing()) ? faPause : faPlay} />\n        </button>\n    );\n}\n\nexport default usePlayer;","import { faSpinner } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport querystring, { ParsedUrlQueryInput } from 'querystring';\nimport React, { SyntheticEvent, useEffect, useMemo, useState } from 'react';\nimport API from './Api';\nimport { IList, IModel } from './Models';\n\n/**\n * React hook to subscibe to a specific api endpoint\n * @param endpoint The url\n * @param params Optional query parameters\n */\nexport function useApi<R>(endpoint: string, params?: ParsedUrlQueryInput) {\n    const [result, setResult] = useState<undefined | R>();\n    const [loading, setLoading] = useState(true);\n    const [message, setMessage] = useState<string | undefined>();\n\n    const query = querystring.encode(params);\n    useEffect(() => {\n        setLoading(true);\n        setResult(undefined);\n\n        return API.subscribe<R>(endpoint, query).then((r, e) => {\n            setResult(r);\n            setMessage(e?.message);\n            setLoading(false);\n        })\n    }, [query, endpoint]);\n\n    return [result, loading, message] as [R | undefined, boolean, string | undefined];\n}\n\n/**\n * React hook to fetch an array of of endpoints a single response list\n * @param endpoints The urls\n */\nexport function useApiBunch<R>(endpoints: string[]) {\n    const [unfiltered, setResults] = useState<R[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [messages, setMessages] = useState<string[]>([]);\n\n    const results = useMemo(() => unfiltered.filter(r => !!r), [unfiltered]);\n\n    useEffect(() => {\n        if (results.length === endpoints.length) setLoading(false);\n    }, [results, endpoints])\n\n    useEffect(() => {\n        setLoading(true);\n        setResults([]);\n\n        const unsubscribers = endpoints.map((endpoint, i) => API.subscribe<R>(endpoint)\n            .then((r, e) => {\n                if (e) setMessages(m => {\n                    const n = [...m]\n                    n[i] = e.message;\n                    return n;\n                });\n                else if (r) setResults(rs => {\n                    const n = [...rs];\n                    n[i] = r;\n                    return n;\n                })\n            })\n        );\n\n        return () => unsubscribers.forEach(u => u());\n\n    }, [endpoints]);\n\n    return [results, loading, messages] as [R[], boolean, string[]];\n}\n\n/**\n * Shortcut to retrieve an `IList` of models from the api\n * Will automatically sort by id\n * @param endpoint The url\n * @param params The query params\n */\nexport function useApiList<M extends IModel>(endpoint: string, params?: ParsedUrlQueryInput) {\n    const [models, loading, message] = useApi<IList<M>>(endpoint, params);\n\n    const sorted = useMemo(() => (models?.objects ?? [])\n        .sort((a, b) => a.id - b.id), [models]);\n\n    return [sorted, loading, message] as [M[] | undefined, boolean, string | undefined];\n}\n\n\n/**\n * Shortcut to load an `IList` of models from the api\n * Will automatically sort by id\n * @param endpoint The url\n * @param params The query params\n */\nexport function useLoadingList<M extends IModel>(endpoint: string, params: ParsedUrlQueryInput | Render<M[]>, render?: Render<M[]>): JSX.Element | null {\n    const p = typeof params === 'object' ? params : undefined;\n    const r = typeof params === 'function' ? params : render;\n    const [result, loading, error] = useApiList<M>(endpoint, p);\n\n    if (loading) return <Loading />\n    if (!result) return <span className='empty-info'>{error || 'Not found'}</span>\n    return r ? r(result) : null;\n}\n\n/**\n * React hook to send post requests\n * @param endpoint The url\n * @param data Optional body data\n * @param cb Optional callback function called on success with the response\n */\nexport function useSubmit<R = any>(endpoint: string, data?: any, cb?: (r?: R) => unknown) {\n    const [error, setError] = useState<any>();\n    const [inProgress, setLoading] = useState(false);\n\n    const post = (e?: SyntheticEvent) => {\n        e?.preventDefault();\n        setLoading(true);\n        API.post<R>(endpoint, data)\n            .then(r => {\n                if (cb) cb(r);\n                return undefined;\n            })\n            .catch(e => e as Error)\n            .then(e => {\n                setError(e);\n                setLoading(false);\n            });\n    }\n\n    const message = error?.message;\n    return { message, error, valid: !message, post, inProgress };\n}\n\n/**\n * A universal loading component\n */\nexport const Loading = () => {\n    return <Icon className='loading inline' icon={faSpinner} />\n}\n\nexport type Render<R> = (result: R) => JSX.Element | null;\n\n/**\n * React hook to render loading componets universally\n * @param endpoint The api url\n * @param params Optional query parameters\n * @param render The render function called once the data has been received\n */\nexport function useLoading<R>(endpoint: string, params: ParsedUrlQueryInput | Render<R>, render?: Render<R>): JSX.Element | null {\n    const p = typeof params === 'object' ? params : undefined;\n    const r = typeof params === 'function' ? params : render;\n    const [result, loading, error] = useApi<R>(endpoint, p);\n\n    if (loading) return <Loading />\n    if (!result) return <span className='empty-info'>{error || 'Not found'}</span>\n    return r ? r(result) : null;\n}","import React, { ReactNode, HTMLAttributes } from 'react';\n\nconst Cell = (props: { area: string, children?: ReactNode } & HTMLAttributes<HTMLDivElement>) => {\n    const { children, className, area, style, ...other } = props;\n    return (\n        <div className={`${className ?? ''} ${area}`} style={{ gridArea: area, position: 'relative', ...style }} {...other}>\n            {children}\n        </div>\n    );\n}\n\nexport default Cell;","import React, { useContext, useEffect, useRef } from 'react';\n\nexport interface DialogProps {\n    text: string;\n    buttons: {\n        text: string;\n        className?: string;\n        click?: () => unknown\n    }[];\n}\n\nexport const GenericDialog = ({ dialog }: { dialog: DialogProps }) => {\n    const { close } = useDialog();\n\n    return (\n        <div className='generic'>\n            <p>{dialog.text}</p>\n            <ul>\n                {dialog.buttons.map(({ text, className, click }, i) =>\n                    <button key={i} onClick={() => {\n                        if (click) click();\n                        close();\n                    }} {...{ className }}>\n                        {text}\n                    </button>\n                )}\n            </ul>\n        </div>\n    )\n}\n\nconst Dialog = () => {\n    const [children] = useContext(DialogContext);\n    const { close } = useDialog();\n    const ref = useRef(null);\n\n    useEffect(() => {\n        const listener = (e: KeyboardEvent) => {\n            if (e.keyCode === 27) close();\n        }\n        window.addEventListener('keydown', listener);\n        return () => window.removeEventListener('keydown', listener);\n    })\n\n    return (\n        <>\n            {children && <div onClick={close} className='curtain' />}\n            {/*<CSSTransition in={!!children} key='dialog' timeout={200} {...{ ref }}>*/}\n            {children &&\n                <div className='dialog enter-done' {...{ ref }}>\n                    {children}\n                </div>\n            }\n            {/*</CSSTransition>*/}\n        </>\n    )\n}\n\nconst DialogContext = React.createContext<[\n    JSX.Element | null,\n    (d: JSX.Element | null) => void\n]>([null, () => { }]);\n\nexport const useDialog = () => {\n    const [, open] = useContext(DialogContext);\n    const close = () => open(null);\n    return { open, close };\n}\n\nexport const Provider = DialogContext.Provider;\n\nexport default Dialog;","import { faCompactDisc, faDrum, faGuitar, faHeadphones, faMusic, faPlus, faRecordVinyl } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport classes from 'classnames';\nimport React, { CSSProperties, useMemo, useState } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { Render, useLoading, useLoadingList } from '../api/Hooks';\nimport { IModel } from '../api/Models';\nimport Cell from './Cell';\nimport { useDialog } from './Dialog';\nimport API from '../api/Api';\n\nconst ICONS = [faHeadphones, faMusic, faGuitar, faDrum, faRecordVinyl, faCompactDisc];\n\nexport const Cover = (props: { alt: string, src?: string } & CSSProperties) => {\n    const { src, alt, ...rest } = props;\n    const [hasImage, setImage] = useState(false);\n\n    const icon = useMemo(() => ICONS[Math.floor(Math.random() * ICONS.length)], [])\n\n    return <Cell area='cover' style={{ ...rest }}>\n        <img\n            onLoad={() => setImage(true)}\n            onError={() => setImage(false)}\n            draggable={false}\n            {... { alt, src }}\n        />\n        {!hasImage && <Icon icon={icon} />}\n    </Cell>\n}\n\nexport function ModelView<M extends IModel>(props: { endpoint: string, render: Render<M>, create?: (() => JSX.Element) | true }) {\n    const { endpoint, create } = props;\n    const { id } = useParams();\n\n    return (\n        <>\n            <ModelSidebar {...{ endpoint, create }} />\n            <Cell area='active'>\n                {id\n                    ? <Single {...{ id }} {...props} />\n                    : <h1>Select a{endpoint.match(/^[aeiou]/i) ? 'n' : ''} {endpoint}</h1>\n                }\n            </Cell>\n        </>\n    )\n}\n\nfunction Single<M extends IModel>(props: { endpoint: string, id: string, render: Render<M> }) {\n    const { id, endpoint, render } = props;\n    return useLoading<M>(`${endpoint}/${id}`, m =>\n        <>\n            <h1>{m.name}</h1>\n            {render(m)}\n        </>\n    );\n}\n\nconst Create = ({ endpoint }: { endpoint: string }) => {\n    const [name, setName] = useState('');\n    const { close } = useDialog();\n\n    const submit = (e: React.FormEvent) => {\n        e.preventDefault();\n        close();\n        API.post(endpoint, { name })\n            .catch(e => console.error(e));\n    }\n\n    const disabled = name.length < 1;\n\n    return <form className='create' onSubmit={submit}>\n\n        <input className='big' value={name} onChange={e => setName(e.target.value)} type='text' placeholder='Name' />\n        <button className={classes('primary', { disabled })} type='submit'>Create</button>\n\n    </form>\n}\n\nexport function ModelSidebar<M extends IModel>({ endpoint, ...props }: { endpoint: string, create?: (() => JSX.Element) | boolean }) {\n    const { id: active } = useParams();\n    const { open } = useDialog();\n\n    const create = props.create ? () => {\n        if (typeof props.create === 'function') return props.create();\n        return <Create {...{ endpoint }} />\n    } : null;\n\n    return useLoadingList<M>(endpoint, models =>\n        <Cell area='list'>\n            {create && <button onClick={() => open(create())}>\n                <Icon icon={faPlus} />\n            </button>}\n            <ul className='list'>\n                {(models.length > 0)\n                    ? models.map(({ name, id }) =>\n                        <Link key={id} to={`/${endpoint}s/${id}`}>\n                            <li className={classes({ active: id.toString() === active })}>\n                                {name}\n                            </li>\n                        </Link>\n                    )\n                    : <li className='empty-info'>No {endpoint}s yet</li>\n                }\n            </ul>\n        </Cell>\n    );\n}","import React from 'react';\nimport Cell from './Cell';\nimport { IAlbum, ISong } from '../api/Models';\nimport { useApi } from '../api/Hooks';\nimport { NO_COVER } from './App'\nimport usePlayer from '../api/Audio';\nimport { Cover } from './Shared';\n\nconst ActiveSong = () => {\n    const { song } = usePlayer();\n    return song\n        ? <ActiveCover {...song} />\n        : <Cover alt='No song playing' />;\n}\n\nconst ActiveCover = (song: ISong) => {\n    const [album] = useApi<IAlbum>(song.album);\n\n    return (\n        <Cover\n            src={album?.cover_url}\n            alt='Active Song Cover'\n        />\n    )\n}\n\nexport default ActiveSong;","import { faCheck, faUpload } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport classes from 'classnames';\nimport React, { Dispatch, SetStateAction, useEffect, useMemo, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport API from '../api/Api';\nimport { Loading, useApiList, useLoading } from '../api/Hooks';\nimport { IAlbum, IModel, ISong } from '../api/Models';\nimport Cell from './Cell';\nimport { useDialog } from './Dialog';\n\nconst fileName = (f: File) => f.name.substring(0, f.name.lastIndexOf('.'));\n\nconst Upload = React.memo(() => {\n    const [files, setFiles] = useState<File[]>([]);\n    const [uploading, setUploading] = useState<File[]>([]);\n\n    const upload = () => {\n        setUploading(u => [...files, ...u])\n        setFiles([]);\n    }\n\n    return (\n        <>\n            <form onSubmit={e => {\n                e.preventDefault();\n                upload();\n            }}>\n\n                <label role=\"button\" className=\"file\" htmlFor=\"file\">\n                    <span>Choose Files</span>\n                    <Icon icon={faUpload} />\n                </label>\n\n                <input onChange={e => setFiles([...(e.target.files ?? []) as File[]])} multiple id=\"file\" type=\"file\" accept=\"audio/mp3\" hidden />\n\n                <button className={classes({ disabled: files.length === 0 })} type=\"submit\">\n                    Upload {files.length ? `${files.length} Song` : ''}\n                </button>\n\n            </form>\n\n            <ul className='uploading'>\n                {uploading.map(f => <Uploading key={f.name} file={f} />)}\n            </ul>\n        </>\n    )\n});\n\nconst Uploading = ({ file }: { file: File }) => {\n    const [done, setDone] = useState(false);\n    const name = fileName(file);\n\n    useEffect(() => {\n        setDone(false);\n        API.upload('song', file)\n            .catch(e => console.error(e))\n            .then(() => setDone(true))\n    }, [file]);\n\n    return (\n        <li className={classes({ done })}>\n            {done\n                ? <Icon icon={faCheck} />\n                : <Loading />\n            }\n            <span>{name}</span>\n        </li>\n    );\n}\n\ntype State<T> = [T, Dispatch<SetStateAction<T>>];\n\nexport function ModelSelect<T extends IModel>(props: { endpoint: string, state: State<string | null>, name?: string, highlight?: (t: T) => boolean }) {\n    const { endpoint, state, name, highlight } = props;\n    const [initial, onChange] = state;\n    const [create, setCreate] = useState(false);\n\n    const [models] = useApiList<T>(endpoint);\n\n    const sorted = useMemo(() => {\n        if (!highlight || !models) return models ?? [];\n        return [...models].sort((a, b) => {\n            const [ia, ib] = [a, b].map(highlight).map(b => b ? -1 : 1);\n            return ia - ib;\n        });\n    }, [highlight, models]);\n\n    const set = (v: string) => {\n        if (v === 'create') setCreate(true)\n        else {\n            setCreate(false);\n            const v2 = v.length > 0 ? v : null;\n            onChange(v2);\n        }\n    }\n\n    return <>\n        <select value={initial ?? ''} id={name ?? endpoint} name={name ?? endpoint} onChange={e => set(e.target.value)}>\n            {sorted.length > 0 &&\n                <>\n                    <option value=''>Select an {endpoint}</option>\n                    <option value='create'>Create an {endpoint}</option>\n                    {sorted.map(m =>\n                        <option\n                            className={classes({ highlight: highlight && highlight(m) })}\n                            key={m.id}\n                            value={m.resource_uri}>\n                            {m.name}\n                        </option>\n                    )}\n                </>\n            }\n        </select>\n        {create && <input type='text' />}\n    </>\n\n}\n\nexport const MultiModelSelect = (props: { endpoint: string, state: State<string[]> }) => {\n    const { endpoint, state } = props;\n    const [initial, onChange] = state;\n    const [models, set] = useState<(null | string)[]>(initial.length > 0 ? initial : [null]);\n\n    useEffect(() => {\n        onChange(models.filter(m => !!m) as string[]);\n    }, [models]);\n\n    return <div className='multi-select'>\n        {models.map((model, i) =>\n            <ModelSelect name={`${endpoint}[]`} key={i} {...{ endpoint }} state={[\n                model, action => {\n                    const n = [...models];\n                    const a = typeof action === 'function' ? action(model) : action;\n\n                    if (a || i === 0) n[i] = a;\n                    else n.splice(i, 1);\n\n                    set(n);\n                }\n            ]} />\n        )}\n        {models[models.length - 1] && <button onClick={() => set([...models, null])}>Add</button>}\n    </div>;\n}\n\nexport const SongEditor = () => {\n    const { id } = useParams();\n    return useLoading<ISong>(`song/${id}`, s => <LoadedSongEditor song={s} />)\n}\n\nexport const LoadedSongEditor = ({ song }: { song?: ISong }) => {\n    const { close } = useDialog();\n\n    const [title, setTitle] = useState<string>(song?.title ?? '');\n    const [album, setAlbum] = useState<null | string>(song?.album ?? null);\n    const [artists, setArtists] = useState<string[]>(song?.artists ?? []);\n\n    const highlight = useMemo(() => (album: IAlbum) =>\n        artists.every(a => album.artists.includes(a)), [artists]\n    );\n\n    const data = { artists, album, title };\n\n    return (\n        <form className='editor' onSubmit={e => {\n            e.preventDefault();\n            close();\n            if (song) API.put(`song/${song.id}`, data)\n                .catch(e => console.error(e))\n        }}>\n\n            <Cell area='title'>\n                <label htmlFor='title'>Title</label>\n                <input className='big' id='title' type='text' placeholder='Title' value={title} onChange={e => setTitle(e.target.value)} />\n            </Cell>\n\n            <Cell area='artists'>\n                <label>Artists</label>\n                <MultiModelSelect endpoint='artist' state={[artists, setArtists]} />\n            </Cell>\n\n            <Cell area='album'>\n                <label htmlFor='album'>Album</label>\n                <ModelSelect endpoint='album' state={[album, setAlbum]} {...{ highlight }} />\n            </Cell>\n\n            <input type='submit' className='primary' value='Save' />\n\n        </form>\n    )\n}\n\nexport default Upload;\n\n","import { faEdit, faList, faPlus, IconDefinition } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport classes from 'classnames';\nimport React, { useEffect, useMemo, useState, memo } from 'react';\nimport { Link } from 'react-router-dom';\nimport API from '../api/Api';\nimport usePlayer, { SongButton } from '../api/Audio';\nimport { Loading, useApi, useLoading, useApiList } from '../api/Hooks';\nimport { IAlbum, IArtist, IList, IModel, IPlaylist, ISong } from '../api/Models';\nimport { useDialog } from './Dialog';\nimport { LoadedSongEditor } from './Upload';\n\ninterface ISelection<T> {\n    isSelected(id: number): boolean;\n    selected: () => T[];\n    events(id: number): {\n        onMouseDown(e: React.MouseEvent): void;\n        onMouseUp(e: React.MouseEvent): void;\n        onMouseMove(e: React.MouseEvent): void;\n    }\n}\n\n//\nexport function useSelection<T extends IModel>(models: T[], multi = true): ISelection<T> {\n    const [selected, setSelected] = useState<number[]>([]);\n    const [saved, setSaved] = useState<number[]>([]);\n    const [last, setLast] = useState<number>();\n\n    const ids = useMemo(() => models.map(m => m.id), [models]);\n\n    useEffect(() => {\n        const listener = (e: KeyboardEvent) => {\n            if (e.ctrlKey && e.keyCode === 65) {\n                e.preventDefault();\n                setSelected([...ids]);\n                setSaved([...ids]);\n            }\n        }\n        window.addEventListener('keydown', listener);\n        return () => window.removeEventListener('keydown', listener);;\n    })\n\n    const isSelected = (m: T | number) => {\n        const id = typeof m === 'number' ? m : m.id;\n        return selected.includes(id);\n    }\n\n    const events = (id: number) => {\n        const index = ids.indexOf(id);\n        const is = isSelected(id);\n\n        return {\n            onMouseDown: (e: React.MouseEvent) => {\n                const preserve = (e.shiftKey || e.ctrlKey) && multi;\n                const n = preserve ? saved : [];\n\n                if (is && e.ctrlKey && multi) {\n                    n.splice(index, 1);\n                } else {\n                    n.push(id);\n                }\n\n                if (!e.shiftKey) {\n                    setLast(index);\n                    setSaved(n);\n                }\n\n                setSelected(n);\n            },\n            onMouseUp: (e: React.MouseEvent) => {\n                const shift = e.shiftKey;\n\n                if (multi && shift && last !== undefined) setSelected(old => {\n                    const n = [...old];\n\n                    const lower = Math.min(last, index);\n                    const upper = Math.max(last, index);\n                    for (let i = lower; i <= upper; i++) n.push(ids[i]);\n\n                    return n;\n                })\n            },\n            onMouseMove: (e: React.MouseEvent) => {\n                if (e.buttons) {\n                    const n = [...saved];\n                    if (last !== undefined) {\n                        const lower = Math.min(last, index);\n                        const upper = Math.max(last, index);\n                        for (let i = lower; i <= upper; i++) n.push(ids[i]);\n                    }\n                    setSelected(n);\n                }\n            }\n        }\n    };\n\n    return { selected: () => models.filter(m => isSelected(m.id)), isSelected, events };\n}\n\nexport interface SongAction {\n    icon: IconDefinition;\n    display: string | ((i: number) => string);\n    action: (songs: ISong[]) => void;\n}\n\n/**\n * Displays a dialog to select a playlist\n * @param param0.songs The songs to add\n */\nconst SongAdder = ({ songs }: { songs: ISong[] }) => {\n    const { close } = useDialog();\n\n    const [playlists] = useApiList<IPlaylist>('playlist');\n\n    const { isSelected, events, ...selection } = useSelection<IPlaylist>(playlists ?? [], false);\n    const [selected]: (IPlaylist | undefined)[] = selection.selected();\n\n    const submit = () => {\n        Promise.all(songs.filter(s => isSelected(s.id)).map(song =>\n            API.post('songinplaylist', { song: song.resource_uri, playlist: selected.resource_uri }, false)\n                .catch(e => console.error(e))\n        )).then(() => API.update());\n        close();\n    }\n\n    if (!playlists) return <Loading />\n\n    return (\n        <div className='add-songs demarg'>\n            <button className={classes('primary', { disabled: !selected })} onClick={submit}>\n                Add {songs.length} to playlist\n            </button>\n            <ul>\n                {playlists.map(({ name, id }) =>\n                    <li key={id} className={classes({ selected: isSelected(id) })} {...events(id)}>{name}</li>\n                )}\n            </ul>\n        </div>\n    );\n}\n\n/**\n * The song table used in various views\n * \n * @param param0.songs The songs to display\n * @param param0.actions Possible actions to do with selected songs, will be shows as buttons above table\n */\nconst Songs = memo(({ songs, ...props }: { songs: ISong[], actions?: SongAction[] }) => {\n    const selection = useSelection(songs);\n    const { open } = useDialog();\n\n    const actions = useMemo(() => [...props.actions ?? [], {\n        icon: faPlus,\n        display: i => `Add ${i} song${i === 1 ? '' : 's'} to playlist`,\n        action: songs => open(<SongAdder {...{ songs }} />)\n    }], [props.actions]);\n    \n    if ((songs?.length ?? 0) === 0) return <p style={{ gridArea: 'songs' }} className='empty-info'>No songs yet</p>\n\n    const selected = selection.selected();\n\n    return (\n        <div className='songlist'>\n            <div className='actions'>\n                {(selected.length > 0) ? actions.map(({ icon, display, action }, i) => {\n                    const text = typeof display === 'string' ? display : display(selected.length);\n\n                    return (\n                        <button key={i} className={classes({ disabled: selected.length === 0 })} onClick={() => action(selected)}>\n                            <Icon {...{ icon }} />\n                            <span>{text}</span>\n                        </button>\n                    )\n\n                }) : <p className='empty-info'>No songs selected</p>}\n            </div>\n            <div className='table'>\n                <div>\n                    <p />\n                    <p>Title</p>\n                    <p>Artists</p>\n                    <p>Album</p>\n                    <p>Length</p>\n                    <p />\n                    <p />\n                </div>\n                {songs.map(song =>\n                    <SongRow\n                        {...{ selection }}\n                        key={song.id} {...{ song, songs }}\n                    />\n                )}\n            </div>\n        </div>\n    )\n});\n\n/**\n * The component for a single row in the songs table\n * @param props.song The song\n * @param props.selection The selection context of the table\n * @param props.songs All songs in the current view. Used to set queue when playing the song\n */\nconst SongRow = (props: { song: ISong | string, selection?: ISelection<ISong>, songs?: ISong[] }) => {\n    const { song, selection, songs } = props;\n    const { open } = useDialog();\n    const { queue } = usePlayer();\n\n    if (typeof song === 'string') return <LoadingSongRow url={song} {...{ selection }} />\n\n    const { album, artists, title, length, id } = song;\n    const selected = selection?.isSelected(id) ?? false;\n\n    return (\n        <div className={classes({ selected })} {...selection?.events(id)}>\n            <SongButton {...{ song, songs }} />\n\n            <p>{title}</p>\n            <p>{artists.map(a =>\n                <Artist key={a} url={a} />\n            )}</p>\n            <p><Album url={album} /></p>\n            <p>{length}</p>\n\n            <IconButton icon={faEdit} onClick={() => open(<LoadedSongEditor {...{ song }} />)} />\n            <IconButton icon={faList} onClick={() => queue?.add(song)} />\n\n        </div>\n    );\n}\n\nconst IconButton = ({ onClick, icon }: { onClick?: () => void, icon: IconDefinition }) => {\n\n    return <button {...{ onClick }}>\n        <Icon {...{ icon }} />\n    </button>\n}\n\nconst LoadingSongRow = ({ url, ...rest }: { url: string, selection?: ISelection<ISong> }) => {\n    return useLoading<ISong>(url, song => <SongRow {...rest} {...{ song }} />);\n}\n\nconst Artist = ({ url }: { url: string }) => {\n    const [a] = useApi<IArtist>(url);\n    return a ? <Link className='seperate-comma' to={`/artists/${a.id}`}>{a.name}</Link> : null;\n}\n\nconst Album = ({ url }: { url: string }) => {\n    const [a] = useApi<IAlbum>(url);\n    return a ? <Link className='seperate-comma' to={`/albums/${a.id}`}>{a.name}</Link> : null;\n}\n\nexport default Songs;","import React, { useMemo, useEffect } from 'react';\nimport { IAlbum, IArtist, ISong } from '../api/Models';\nimport { ModelView, Cover } from './Shared';\nimport SongList from './SongList';\nimport Cell from './Cell';\nimport { useLoading, useApiBunch } from '../api/Hooks';\nimport { Link } from 'react-router-dom';\n\nconst Active = ({ name, artists, songs: songURLs, cover_url }: IAlbum) => {\n    const [songs] = useApiBunch<ISong>(songURLs);\n\n    return (\n        <>\n            <Cover src={cover_url} alt={name} />\n            <Cell area='artists'>\n                {artists.map(a => <Artist key={a} url={a} />)}\n            </Cell>\n            <SongList {...{ songs }} />\n        </>\n    )\n}\n\nconst Artist = ({ url }: { url: string }) => {\n    return useLoading<IArtist>(url, ({ name, id }) =>\n        <Link to={`/artists/${id}`}>{name}</Link>\n    );\n}\n\nconst Albums = React.memo(() => {\n    return <ModelView create endpoint='album' render={(a: IAlbum) => <Active {...a} />} />\n});\n\nexport default Albums;","import React, { memo } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { Loading, useApi, useLoading } from '../api/Hooks';\nimport { IAlbum, IArtist, IList, ISong } from '../api/Models';\nimport Cell from './Cell';\nimport { Cover, ModelView } from './Shared';\n\nconst Artists = React.memo(() => {\n    return <ModelView create endpoint='artist' render={(a: IArtist) => <Artist {...a} />} />;\n});\n\nconst Artist = ({ albums }: IArtist) => {\n    return (\n        <>\n            <Cell area='albums'>\n                {albums.length > 0\n                    ? albums.map(a => <Album key={a} url={a} />)\n                    : <p className='empty-info'>No albums yet</p>\n                }\n            </Cell>\n        </>\n    );\n};\n\nconst Album = ({ url }: { url: string }) => {\n    return useLoading<IAlbum>(url, ({ cover_url, name, release, songs, id }) => (\n        <Link to={`/albums/${id}`}>\n            <h5>{name} - (Genre {release})</h5>\n            <Cover\n                src={cover_url}\n                alt='Cover'\n            />\n            <table>\n                <tbody>\n                    {(songs.length > 0)\n                        ? songs.map(t => <SongRow key={t} url={t} />)\n                        : <tr><td className='empty-info'>No songs yet</td></tr>\n                    }\n                </tbody>\n            </table>\n        </Link>\n    ));\n}\n\nconst SongRow = ({ url }: { url: string }) => {\n    const [song] = useApi<ISong>(url);\n\n    return (\n        <tr>\n            {song\n                ? <>\n                    <td>{song.name}</td>\n                    <td>{song.length}</td>\n                </>\n                : <td rowSpan={2}><Loading /></td>\n            }\n        </tr>\n    );\n}\n\nexport default Artists;","import { faCompactDisc, faList, faMusic, faUser, faSeedling, faDoorOpen, faUpload } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport classes from 'classnames';\nimport React from 'react';\nimport { Link, useLocation } from 'react-router-dom';\n\n/**\n * Navigation bar\n */\nconst Nav = () => {\n    const path = useLocation().pathname;\n\n    const links = [\n        { href: '/songs', text: 'Songs', icon: faMusic },\n        { href: '/playlists', text: 'Playlists', icon: faList },\n        { href: '/albums', text: 'Albums', icon: faCompactDisc },\n        { href: '/artists', text: 'Artists', icon: faUser },\n        { href: '/upload', text: 'Upload', icon: faUpload },\n        { href: '/logout', text: 'Logout', icon: faDoorOpen },\n    ];\n\n    return (\n        <nav>\n            <ul>\n                {links.map(({ text, href, icon }) =>\n                    <Link key={href} to={href}>\n                        <li className={classes({ active: path === href })}>\n                            <span>{text}</span>\n                            <Icon {...{ icon }} />\n                        </li>\n                    </Link>\n                )}\n            </ul>\n        </nav>\n    );\n}\n\nexport default Nav;\n","import React, { createContext, Dispatch, SetStateAction, useContext, useState, useEffect } from 'react';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport { faSun, faMoon, faExclamation, IconDefinition, faFire } from '@fortawesome/free-solid-svg-icons';\n\nexport interface ISettings {\n    theme: string;\n}\n\nexport const DEFAULT_SETTINGS = { theme: 'dark' }\n\nconst SettingsContext = createContext<[ISettings, Dispatch<SetStateAction<ISettings>>]>(\n    [DEFAULT_SETTINGS, () => { }]\n);\n\n/**\n * einstellbare Settings: Farbethema der Icons\n */\nconst Settings = () => {\n    const [, setSettings] = useContext(SettingsContext);\n\n    const themes: [string, IconDefinition][] = [\n        ['dark', faMoon],\n        ['light', faSun],\n        ['red', faFire],\n    ];\n\n    return <div className='settings'>\n\n        <h1>Settings</h1>\n\n        <ul>\n            {themes.map(([theme, icon]) =>\n                <button key={theme} className='icon-button' onClick={() => setSettings(s => ({ ...s, theme }))}>\n                    <Icon {...{ icon }} />\n                </button>\n            )}\n        </ul>\n    </div>\n}\n\nexport function useSettings() {\n    const saved = localStorage.getItem('settings')\n    const defaultSettings = saved ? JSON.parse(saved) : DEFAULT_SETTINGS;\n\n    const [settings, setSettings] = useState<ISettings>(defaultSettings)\n\n    useEffect(() => {\n        localStorage.setItem('settings', JSON.stringify(settings));\n    }, [settings])\n\n    return [settings, setSettings] as [ISettings, Dispatch<SetStateAction<ISettings>>];\n}\n\nexport const Provider = SettingsContext.Provider;\n\nexport default Settings;","import React, { useState, MouseEvent } from 'react';\nimport Cell from './Cell';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport { IconDefinition } from '@fortawesome/fontawesome-common-types';\nimport { faPlay, faStepForward, faStepBackward, faRandom, faVolumeDown, faVolumeUp, faVolumeMute, faRedoAlt, faPause, faList, faCog } from '@fortawesome/free-solid-svg-icons'\nimport { IArtist, ISong } from '../api/Models';\nimport { useApi } from '../api/Hooks';\nimport usePlayer, { IQueue, useVolume } from '../api/Audio';\nimport { useDialog } from './Dialog';\nimport classes from 'classnames';\nimport { setPriority } from 'os';\nimport Settings from './Settings';\n\nconst IconButton = (props: { icon: IconDefinition, area?: string, onClick?: () => unknown, disabled?: boolean, active?: boolean }) => {\n    const { area, icon, disabled, onClick, active } = props;\n    return (\n        <Cell className={classes('icon-button', { disabled: disabled || !onClick, active })} area={area ?? ''} {...{ onClick }}>\n            <Icon {...{ icon }} />\n        </Cell >\n    )\n}\n\n/* Musik-Player Navigation */ \nconst Player = () => {\n    const { song, position, play, pause, playing, songs, queue, previous, next, shuffle, setShuffle, repeat, setRepeat } = usePlayer();\n    const { open } = useDialog();\n\n    return (\n        <Cell area='player'>\n            {song && <SongInfo {...song} {...{ position }} />}\n\n            <IconButton onClick={previous} icon={faStepBackward} area='previous' />\n            <IconButton onClick={next} icon={faStepForward} area='next' />\n            <IconButton onClick={playing() ? pause : () => play()} icon={playing() ? faPause : faPlay} area='play' />\n            <IconButton active={shuffle} onClick={() => setShuffle(b => !b)} icon={faRandom} area='shuffle' />\n            <IconButton active={repeat} onClick={() => setRepeat(b => !b)} icon={faRedoAlt} area='repeat' />\n            <IconButton disabled={songs.length + (queue?.songs.length ?? 0) === 0} icon={faList} area='queue' onClick={() => open(<Queue />)} />\n            <IconButton icon={faCog} area='settings' onClick={() => open(<Settings />)} />\n\n            <Volume />\n        </Cell>\n    );\n}\n\n/*Songs in einer Queue werden nacheinander abgespielt - benutzerdefinierte Queue*/\nconst Queue = () => {\n    const { songs, queue } = usePlayer();\n\n    const sources = [\n        ['Queue', queue?.songs ?? []],\n        ['Next', songs],\n    ].filter(([, s]) => s.length > 0) as [string, ISong[]][];\n\n    return (\n        <div className='queue demarg'>\n            {sources.map(([source, songs]) =>\n                <React.Fragment key={source}>\n                    <p>{source}</p>\n                    <ul key={source}>\n                        {songs.map(({ title, id }, i) =>\n                            <li key={`${id}-${i}`}>{title}</li>\n                        )}\n                    </ul>\n                </React.Fragment>\n            )}\n        </div>\n    );\n}\n\nconst timestamp = (time: number) => {\n    const minutes = Math.floor(time / 60);\n    const seconds = time - minutes * 60;\n    return `${minutes}:${seconds.toFixed(0).padStart(2, '0')}`;\n}\n\nconst SongInfo = (song: ISong & { position: number }) => {\n    const { title, artists, length, position } = song;\n\n    return (\n        <Cell area='info'>\n            <h4>{title}</h4>\n            <p>{artists?.map(a => <Artist key={a} url={a} />)}</p>\n            <div className='song-progress'>\n                <span>{timestamp(position)}</span>\n                <span>-{timestamp(length - position)}</span>\n                <div style={{ width: `${position / length * 100}%` }} />\n            </div>\n        </Cell>\n    );\n}\n\nconst Artist = ({ url }: { url: string }) => {\n    const [a] = useApi<IArtist>(url);\n    return a ? <span>{a.name}</span> : null;\n}\n\n/*Einstellbare Lautstärke*/\nconst Volume = () => {\n    const { volume, setVolume, toggleVolume } = useVolume();\n\n    const icon = volume === 0\n        ? faVolumeMute\n        : volume < 0.5\n            ? faVolumeDown\n            : faVolumeUp\n\n    const adjust = (e: MouseEvent<HTMLDivElement>) => {\n        const w = e.currentTarget.offsetWidth;\n        const l = e.currentTarget.getBoundingClientRect().left;\n        const x = e.clientX - l;\n        const v = x / w;\n        setVolume(v);\n    }\n\n    return (\n        <Cell area='volume'>\n            <IconButton {...{ icon }} onClick={toggleVolume} />\n            <div className='bar' onClick={adjust} onMouseMove={e => {\n                if (e.buttons > 0) adjust(e);\n            }}>\n                <div style={{ width: `${volume * 100}%` }} />\n            </div>\n        </Cell>\n    );\n}\n\nexport default Player;","import React, { useMemo, useState } from 'react';\nimport { IPlaylist, ISong, IList } from '../api/Models';\nimport { ModelView } from './Shared';\nimport SongList, { useSelection } from './SongList';\nimport { useApiBunch, useLoading, useApi, Loading, useApiList } from '../api/Hooks';\nimport { faTrash, faPlus } from '@fortawesome/free-solid-svg-icons';\nimport { useDialog } from './Dialog';\nimport { FontAwesomeIcon as Icon } from '@fortawesome/react-fontawesome';\nimport classes from 'classnames';\nimport API from '../api/Api';\n\nconst SongAdder = ({ songsinplaylist, resource_uri }: IPlaylist) => {\n    const contained = (s: ISong) => songsinplaylist.includes(s.resource_uri);\n    const { close } = useDialog();\n\n    const [all, loading] = useApiList<ISong>('song');\n    const songs = useMemo(() => all?.filter(s => !contained(s)) ?? [], [all]);\n\n    const { isSelected, events, selected } = useSelection<ISong>(songs);\n\n    const submit = () => {\n        const newSongs = selected().map(s => s.resource_uri);\n        API.put(resource_uri, {\n            songsinplaylist: [...songsinplaylist, ...newSongs]\n        }).catch(e => console.error(e));\n        close();\n    }\n\n    if (loading) return <Loading />\n\n    return (\n        <div className='add-songs demarg'>\n            <button className='primary' onClick={submit}>Add selected to playlist</button>\n            <ul>\n                {songs.map(({ title, id }) =>\n                    <li key={id} className={classes({ selected: isSelected(id) })} {...events(id)}>{title}</li>\n                )}\n            </ul>\n        </div>\n    );\n}\n\nconst Active = (playlist: IPlaylist) => {\n    const { songsinplaylist: songURLs } = playlist;\n    const [songs] = useApiBunch<ISong>(songURLs);\n    const { open } = useDialog();\n\n    const remove = (songs: ISong[]) => {\n\n    }\n\n    return <>\n        <button onClick={() => open(<SongAdder {...playlist} />)}>\n            <Icon icon={faPlus} />\n        </button>\n\n        <SongList {...{ songs }} actions={[{\n            icon: faTrash,\n            display: i => `Remove ${i} song${i === 1 ? '' : 's'}`,\n            action: remove,\n        }]} />\n    </>\n}\n\nconst Playlists = React.memo(() => {\n    return <ModelView\n        create={true}\n        endpoint='playlist'\n        render={(p: IPlaylist) => <Active {...p} />}\n    />\n})\n\nexport default Playlists;","import classes from 'classnames';\nimport React from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { useLoadingList } from '../api/Hooks';\nimport { IList, IPlaylist } from '../api/Models';\nimport Cell from './Cell';\n\nconst Playlist = () => {\n    const { id: active } = useParams();\n\n    return useLoadingList<IPlaylist>('playlist', playlists =>\n        <Cell area='playlists'>\n            {(playlists.length > 0)\n                ? <ul className='list'>\n                    {playlists.map(({ id, name }) =>\n                        <Link key={id} to={`/playlists/${id}`}>\n                            <li className={classes({ active: id.toString() === active })}>\n                                {name}\n                            </li>\n                        </Link>\n                    )}\n                </ul>\n                : <p className='empty-info'>No playlists yet</p>\n            }\n        </Cell>\n    );\n}\n\nexport default Playlist;\n\n","import Api from './Api';\nimport { IList, IModel, IArtist, IAlbum, ISong } from './Models';\nimport { Dispatch, SetStateAction } from 'react';\n\nconst songNames = [\n    \"Daunting Moons\",\n    \"The Inside-Out Matter\",\n    \"No One Works At Anger\",\n    \"It Uses They\",\n    \"Pawns At the Spring\",\n    \"The Bowl Find\",\n    \"Obstructing History\",\n    \"Sing Doors\",\n    \"Feverish Thorns\",\n    \"Listen\",\n    \"Thoughts\",\n    \"From The Phantom Penguins\",\n    \"Rule Dos On a Prisoner\",\n    \"Visions In Cadenza\",\n    \"The Ambitious Sweet Child\",\n    \"The Love of Journal\",\n    \"The Magic's Act\",\n    \"Mercy Buy School\",\n    \"Gamble Broadcasting\",\n    \"On They Savior\",\n    \"Dreaming Universes\",\n    \"Missing\",\n    \"Bound Cigars\",\n    \"The Smooth Stream\",\n    \"I Sends Through Expression\",\n    \"No One Finishs Everybody\",\n    \"Something Without the Swords\",\n    \"The Harmony Imagine\",\n    \"Typing Activity\",\n    \"Try Right Now\",\n    \"Bare Machinations\",\n    \"Have\",\n    \"Moment\",\n    \"Of The Venturesome Bond\",\n    \"Photography Cans From a Building\",\n    \"Power From Serenade\",\n    \"The Cool Yearning\",\n    \"The Places of Sweet Child\",\n    \"The Souls's Children\",\n    \"Earaches Listen Crafter\",\n    \"Healing Kneeling\",\n    \"From He Person\",\n    \"Drooling Lines\",\n    \"Undoubted\",\n    \"Bad Outlaws\",\n    \"The Which Island\",\n    \"It Stands Under Expectations\",\n    \"I Puts Its\",\n    \"Date Under the Forever\",\n    \"The Death Give\",\n    \"Slaughtering Matter\",\n    \"Lose War\",\n    \"Solitary Body\",\n    \"Drink\",\n    \"Touch\",\n    \"Like The Same Fair\",\n    \"Building Feels Under a Rose\",\n    \"Flames Of Official\",\n    \"The Abandoned Disk\",\n    \"The Height of Silk\",\n    \"The Anything's Terror\",\n    \"Hope Understand Muse\",\n    \"Village Sailing\",\n    \"Through We Woman\",\n    \"Pleading Names\",\n    \"Hungry\"\n];\n\nconst artistNames = [\n    'Talking Heads',\n    'Carl Perkins',\n    'Curtis Mayfield',\n    'R.E.M.',\n    'Diana Ross and the Supremes',\n    'Lynyrd Skynyrd',\n    'Nine Inch Nails',\n    'Booker T. and the MGs',\n    'Guns n’ Roses',\n    'Tom Petty',\n    'Carlos Santana',\n    'The Yardbirds',\n    'Jay-Z',\n    'Gram Parsons',\n    'Tupac Shakur',\n    'Black Sabbath',\n    'James Taylor',\n    'Eminem',\n    'Creedence Clearwater Revival',\n    'The Drifters',\n    'Elvis Costello',\n    'The Four Tops',\n    'The Stooges',\n    'Beastie Boys',\n    'The Shirelles',\n    'Eagles',\n    'Hank Williams',\n    'Radiohead',\n    'AC/DC',\n    'Frank Zappa',\n    'The Police',\n    'Jackie Wilson',\n    'The Temptations',\n    'Cream',\n    'Al Green',\n    'The Kinks',\n    'Phil Spector',\n    'Tina Turner',\n    'Joni Mitchell',\n    'Metallica',\n    'The Sex Pistols',\n    'Aerosmith',\n    'Parliament and Funkadelic',\n    'Grateful Dead',\n    'Dr. Dre',\n    'Eric Clapton',\n    'Howlin’ Wolf',\n    'The Allman Brothers Band',\n    'Queen',\n    'Pink Floyd'\n]\n\n/**\n * @param array The array to select from\n * @param i The amount to select\n * @returns A specified amout of random entries of the given array\n */\nfunction range<T>(array: T[], i: number) {\n    return array.sort((a, b) => Math.random() - 0.5).slice(0, Math.min(array.length, i));\n}\n\n/**\n * @param array The array to select from\n * @returns A random entry of the given array\n */\nfunction random<T>(array: T[]) {\n    return range(array, 1)[0];\n}\n\n/**\n * @returns A random date\n */\nconst randomDate = () => {\n    return `${1960 + Math.floor(Math.random() * 60)}`;\n}\n\n/**\n * Used to display loading progress and information\n */\nexport interface ITracker {\n    setTotal: Dispatch<SetStateAction<number>>,\n    setProgress: Dispatch<SetStateAction<number>>,\n    setMessage?: Dispatch<SetStateAction<string | null>>,\n}\n\nclass Seeder {\n\n    tags(count: number) {\n        return []\n    }\n\n    artists(count: number) {\n        return range(artistNames, count).map(name => ({ name, type: 'P' }));\n    }\n\n    albums(artists: IArtist[]) {\n        const artistIds = artists.map(a => a.resource_uri);\n        return (count: number) => range(songNames, count).map(name => ({\n            name,\n            artists: range(artistIds, 2),\n            release: randomDate(),\n        }));\n    }\n\n    songs(albums: IAlbum[]) {\n        return (count: number) => range(songNames, count).map(title => {\n            const { artists, resource_uri } = random(albums);\n            return {\n                title,\n                artists,\n                album: resource_uri,\n                length: Math.floor(Math.random() * 100 + 100),\n            };\n        })\n    }\n\n    playlists(count: number) {\n        return new Array(count).fill(null).map((_, i) => ({\n            name: 'Playlist ' + i,\n        }));\n    }\n\n    private wait(millis: number) {\n        return new Promise(res => setTimeout(res, millis));\n    }\n\n    private async seedModels<M extends IModel>(endpoint: string, count: number, generator: (i: number) => unknown[], tracker?: ITracker) {\n\n        tracker?.setMessage?.call(null, `Fetching ${endpoint}s`)\n        tracker?.setProgress(0);\n\n        const old = await Api.fetch<IList<IModel>>(endpoint);\n        tracker?.setTotal(old.objects.length + count);\n\n        tracker?.setMessage?.call(null, `Deleting ${endpoint}s`)\n        await Promise.all(old.objects.map(m =>\n            Api.delete(m.resource_uri, {}, false)\n                .catch(e => console.error(e))\n                .then(() => tracker?.setProgress(i => i + 1))\n        ));\n\n        tracker?.setMessage?.call(null, `Seeding ${endpoint}s`)\n        await Promise.all(generator(count).map(m =>\n            Api.post(endpoint, m, false)\n                .catch(e => console.error(e))\n                .then(() => tracker?.setProgress(i => i + 1))\n        ));\n\n        const { objects } = await Api.fetch<IList<M>>(endpoint);\n        return objects;\n    }\n\n    async uploadFile(songs: ISong[], tracker?: ITracker) {\n        tracker?.setTotal(songs.length);\n        tracker?.setProgress(0);\n        tracker?.setMessage?.call(null, 'Uploading Songs');\n\n        songs.map(() => {\n\n            const audio = require('../test.mp3');\n            console.log(audio);\n\n            tracker?.setProgress(i => i + 1);\n        });\n    }\n\n    /**\n     * Seeds the server database with dummy models\n     * @param tracker an optional loading progress tracker\n     */\n    async seed(tracker?: ITracker) {\n\n        const artists = await this.seedModels<IArtist>('artist', 20, this.artists, tracker);\n        const albums = await this.seedModels<IAlbum>('album', 20, this.albums(artists), tracker);\n        const songs = await this.seedModels<ISong>('song', 70, this.songs(albums), tracker);\n        await this.uploadFile(songs, tracker);\n\n\n        tracker?.setMessage?.call(null, 'Done');\n        this.wait(200);\n        tracker?.setTotal(0);\n        tracker?.setMessage?.call(null, null);\n\n        Api.update();\n\n    }\n\n}\n\nconst SEEDER = new Seeder();\n\nexport default SEEDER;","import React, { useState } from 'react';\nimport SEEDER from \"../api/Seeder\";\nimport classes from 'classnames';\nimport { useApi, Loading } from '../api/Hooks';\nimport { IList } from '../api/Models';\n\ninterface IEndpoints {\n    [key: string]: {\n        list_endpoint: string,\n        schema: string\n    }\n}\n\nconst ignore = [\n    'songinplaylist',\n    'track',\n    'apikey',\n]\n\nconst Endpoint = ({ endpoint }: { endpoint: string }) => {\n    const [models] = useApi<IList<unknown>>(endpoint);\n    const count = models?.objects?.length;\n\n    if(models && count === undefined) return null;\n\n    return (\n        <div>\n            <p>{endpoint}</p>\n            <p>\n                {models\n                    ? `${count} model${count === 1 ? '' : 's'}`\n                    : <Loading />\n                }\n            </p>\n        </div>\n    )\n}\n\nconst Seeder = React.memo(() => {\n    const [progress, setProgress] = useState(0);\n    const [total, setTotal] = useState(0);\n    const [message, setMessage] = useState<string | null>(null);\n    const loading = (total > 0);\n\n    const [endpoints] = useApi<IEndpoints>('');\n\n    const seed = () => SEEDER.seed({ setProgress, setTotal, setMessage }).catch(e => console.error(e))\n\n    return (\n        <>\n            <div className='endpoints'>\n                {endpoints && Object.keys(endpoints).filter(e => !ignore.includes(e.toLowerCase())).map(e =>\n                    <Endpoint key={e} endpoint={e} />\n                )}\n            </div>\n\n            <button className={classes({ disabled: loading })} onClick={seed}>\n                <p>{loading ? 'Seeding...' : 'Seed!'}</p>\n            </button>\n\n            {loading &&\n                <>\n                    <div className='progress'>\n                        <div style={{ width: `${progress / total * 100}%` }} />\n                        <p>{progress} / {total}</p>\n                    </div>\n                    <p>{message}</p>\n                </>\n            }\n        </>\n    );\n});\n\nexport default Seeder;","import React, { memo } from 'react';\nimport { useLoadingList } from '../api/Hooks';\nimport { IList, ISong } from '../api/Models';\nimport SongList from './SongList';\n\n/**\n * Displays all songs of the User\n */\nconst Songs = memo(() => {\n    return useLoadingList<ISong>('song', songs =>\n        <SongList {...{ songs }} />\n    )\n});\n\nexport default Songs;","import classes from 'classnames';\nimport React, { MemoExoticComponent, ReactNode, useEffect, useState } from 'react';\nimport { BrowserRouter as Router, Redirect, Route, Switch, useLocation } from 'react-router-dom';\nimport Api from '../api/Api';\nimport { Provider as AudioProvider, useCreateAudio } from '../api/Audio';\nimport { Loading } from '../api/Hooks';\nimport '../style/general.scss';\nimport ActiveSong from './ActiveSong';\nimport Albums from './Albums';\nimport Artists from './Artists';\nimport Cell from './Cell';\nimport Dialog, { Provider as DialogProvider } from './Dialog';\nimport Login from './Login';\nimport Messages, { IMessage, Provider as MessageProvider } from './Message';\nimport Nav from './NavBar';\nimport Player from './Player';\nimport Playlists from './Playlists';\nimport PlaylistsBar from './PlaylistsBar';\nimport Seeder from './Seeder';\nimport { Provider as SettingsProvider, useSettings } from './Settings';\nimport Songs from './Songs';\nimport Upload from './Upload';\n\nexport const NO_COVER = require('../img/example-cover.jpg');\n\nconst SinglePage = ({ children }: { children: ReactNode }) => {\n\treturn <section className='single'>{children}</section>;\n}\n\nconst Logout = () => {\n\tuseEffect(() => {\n\t\tApi.logout();\n\t});\n\treturn <Redirect to='' />\n}\n\nconst App = () => {\n\tconst [loggedIn, setLoggedIn] = useState<boolean | null>(null);\n\n\tuseEffect(() => {\n\t\tApi.isLoggedIn().then(b => setLoggedIn(b));\n\t}, []);\n\n\tconst dialog = useState<JSX.Element | null>(null);\n\tconst audio = useCreateAudio();\n\tconst messages = useState<IMessage[]>([]);\n\n\tconst [settings, setSettings] = useSettings();\n\tconst { theme } = settings;\n\n\tconst pages: IPage[] = [\n\t\t{ path: '/playlists/:id?', component: Playlists },\n\t\t{ path: '/artists/:id?', component: Artists },\n\t\t{ path: '/albums/:id?', component: Albums },\n\t\t{ path: '/songs', component: Songs },\n\t\t{ path: '/seed', component: Seeder },\n\t\t{ path: '/upload', component: Upload },\n\t];\n\n\treturn (\n\t\t<SettingsProvider value={[settings, setSettings]}>\n\t\t\t<DialogProvider value={dialog}>\n\t\t\t\t<AudioProvider value={audio}>\n\t\t\t\t\t<MessageProvider value={messages}>\n\t\t\t\t\t\t<Router>\n\t\t\t\t\t\t\t<section className={classes(theme)}>\n\t\t\t\t\t\t\t\t{loggedIn\n\t\t\t\t\t\t\t\t\t? <section className='container'>\n\t\t\t\t\t\t\t\t\t\t<Nav />\n\t\t\t\t\t\t\t\t\t\t<Player />\n\t\t\t\t\t\t\t\t\t\t<ActiveSong />\n\t\t\t\t\t\t\t\t\t\t<PlaylistsBar />\n\n\t\t\t\t\t\t\t\t\t\t<Dialog />\n\t\t\t\t\t\t\t\t\t\t<Messages />\n\n\t\t\t\t\t\t\t\t\t\t<Switch>\n\n\t\t\t\t\t\t\t\t\t\t\t{pages.map(page =>\n\t\t\t\t\t\t\t\t\t\t\t\t<Route key={page.path} path={page.path}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Page {...page} />\n\t\t\t\t\t\t\t\t\t\t\t\t</Route >\n\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t<Route exact path='/'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Redirect to='/playlists' />\n\t\t\t\t\t\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t\t\t\t\t\t<Route path='/logout'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Logout />\n\t\t\t\t\t\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t\t\t\t\t\t<Route>\n\t\t\t\t\t\t\t\t\t\t\t\t<Cell area='page'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h1 className='empty-info'>404 - Not Found</h1>\n\t\t\t\t\t\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t\t\t\t\t</Switch>\n\t\t\t\t\t\t\t\t\t</section>\n\n\t\t\t\t\t\t\t\t\t: <SinglePage>\n\t\t\t\t\t\t\t\t\t\t{loggedIn === false\n\t\t\t\t\t\t\t\t\t\t\t? <Login />\n\t\t\t\t\t\t\t\t\t\t\t: <Loading />\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</SinglePage>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t</Router>\n\n\t\t\t\t\t</MessageProvider>\n\t\t\t\t</AudioProvider>\n\t\t\t</DialogProvider>\n\t\t</SettingsProvider>\n\t);\n}\n\nexport interface IPage {\n\tpath: string;\n\tcomponent: (() => JSX.Element | null) | MemoExoticComponent<() => JSX.Element | null>;\n\tid?: string;\n\ttext?: string;\n}\n\nconst Page = (page: IPage) => {\n\n\tconst path = useLocation().pathname.slice(1) + '/';\n\tconst id = page.id ?? path.slice(0, path.indexOf('/'));\n\n\tuseEffect(() => {\n\t\tdocument.title = 'OSS - ' + id.charAt(0).toUpperCase() + id.slice(1).toLowerCase();\n\t}, [id]);\n\n\treturn (\n\t\t<Cell area='page' id={id}>\n\t\t\t<page.component />\n\t\t</Cell>\n\t);\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport const register = (config?: Config) => {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nconst registerValidSW = (swUrl: string, config?: Config) => {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nconst checkValidServiceWorker = (swUrl: string, config?: Config) => {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport const unregister = () => {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\n//import 'bootstrap/dist/css/bootstrap.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}